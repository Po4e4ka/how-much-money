import{c as se,j as t,r as m,u as rt,H as lt,L as Le}from"./app-U15LX4kB.js";import{T as it,a as dt,b as ot,A as ct}from"./app-layout-Bsw_u8Nq.js";import{d as Ie}from"./index-BDqSilVs.js";import{P as X,O as mt}from"./overlap-period-modal-Bo4DwVPx.js";import{b as xt}from"./app-logo-icon-DBbAu27w.js";/* empty css            */import"./index-DO1Zc_cH.js";import"./index-Dc0I4qgE.js";const ut=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ft=xt("CircleHelp",ut),pt=n=>{const e=se.c(14),{currentTitle:l,onConfirm:i,onCancel:a,confirmDisabled:s}=n,x=s===void 0?!1:s;let d;e[0]===Symbol.for("react.memo_cache_sentinel")?(d=t.jsx("h3",{className:"font-display text-2xl",children:"Закрепить другой период?"}),e[0]=d):d=e[0];const u=l?`Сейчас закреплён период ${l}. Закрепить этот вместо него?`:"Сейчас уже есть закреплённый период. Закрепить этот вместо него?";let o;e[1]!==u?(o=t.jsx("p",{className:"mt-3 text-sm text-[#6a5d52] dark:text-white/70",children:u}),e[1]=u,e[2]=o):o=e[2];let p;e[3]!==a?(p=t.jsx(X,{type:"button",onClick:a,className:"px-4 py-2",children:"Отмена"}),e[3]=a,e[4]=p):p=e[4];let b;e[5]!==x||e[6]!==i?(b=t.jsx(X,{type:"button",onClick:i,tone:"success",className:"px-4 py-2",disabled:x,children:"Закрепить"}),e[5]=x,e[6]=i,e[7]=b):b=e[7];let g;e[8]!==p||e[9]!==b?(g=t.jsxs("div",{className:"mt-6 flex flex-wrap justify-end gap-3",children:[p,b]}),e[8]=p,e[9]=b,e[10]=g):g=e[10];let c;return e[11]!==o||e[12]!==g?(c=t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-6",children:t.jsxs("div",{className:"w-full max-w-xl rounded-lg border border-black/10 bg-white/95 p-6 text-[#1c1a17] shadow-[0_24px_60px_-28px_rgba(0,0,0,0.7)] dark:border-white/10 dark:bg-[#1c1a17] dark:text-white",children:[d,o,g]})}),e[11]=o,e[12]=g,e[13]=c):c=e[13],c},ht=n=>{const e=se.c(10),{onConfirm:l,onCancel:i,confirmDisabled:a}=n,s=a===void 0?!1:a;let x,d;e[0]===Symbol.for("react.memo_cache_sentinel")?(x=t.jsx("h3",{className:"font-display text-2xl",children:"Закрыть период?"}),d=t.jsx("p",{className:"mt-3 text-sm text-[#6a5d52] dark:text-white/70",children:"После закрытия период будет доступен только для просмотра. Редактировать данные больше нельзя."}),e[0]=x,e[1]=d):(x=e[0],d=e[1]);let u;e[2]!==i?(u=t.jsx(X,{type:"button",onClick:i,className:"px-4 py-2",children:"Отмена"}),e[2]=i,e[3]=u):u=e[3];let o;e[4]!==s||e[5]!==l?(o=t.jsx(X,{type:"button",onClick:l,tone:"success",className:"px-4 py-2",disabled:s,children:"Закрыть"}),e[4]=s,e[5]=l,e[6]=o):o=e[6];let p;return e[7]!==u||e[8]!==o?(p=t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-6",children:t.jsxs("div",{className:"w-full max-w-xl rounded-lg border border-black/10 bg-white/95 p-6 text-[#1c1a17] shadow-[0_24px_60px_-28px_rgba(0,0,0,0.7)] dark:border-white/10 dark:bg-[#1c1a17] dark:text-white",children:[x,d,t.jsxs("div",{className:"mt-6 flex flex-wrap justify-end gap-3",children:[u,o]})]})}),e[7]=u,e[8]=o,e[9]=p):p=e[9],p};function bt(n){const e=se.c(14),{text:l,ariaLabel:i}=n,[a,s]=m.useState(!1),[x,d]=m.useState(!1);let u,o;e[0]===Symbol.for("react.memo_cache_sentinel")?(u=()=>{if(typeof window>"u")return;const k=window.matchMedia("(hover: none) and (pointer: coarse)"),S=()=>s(k.matches);return S(),k.addEventListener("change",S),()=>k.removeEventListener("change",S)},o=[],e[0]=u,e[1]=o):(u=e[0],o=e[1]),m.useEffect(u,o);const p=a?x:void 0,b=i??"Подсказка";let g;e[2]!==a?(g=()=>{a&&d(gt)},e[2]=a,e[3]=g):g=e[3];let c;e[4]===Symbol.for("react.memo_cache_sentinel")?(c=t.jsx(ft,{className:"h-4 w-4"}),e[4]=c):c=e[4];let v;e[5]!==b||e[6]!==g?(v=t.jsx(it,{asChild:!0,children:t.jsx("button",{type:"button","aria-label":b,className:"inline-flex h-5 w-5 items-center justify-center rounded-full text-[#6a5d52] transition hover:text-[#1c1a17] dark:text-white/60 dark:hover:text-white",onClick:g,children:c})}),e[5]=b,e[6]=g,e[7]=v):v=e[7];let h;e[8]!==l?(h=t.jsx(dt,{className:"max-w-xs text-xs leading-relaxed",children:l}),e[8]=l,e[9]=h):h=e[9];let y;return e[10]!==p||e[11]!==v||e[12]!==h?(y=t.jsxs(ot,{open:p,onOpenChange:d,children:[v,h]}),e[10]=p,e[11]=v,e[12]=h,e[13]=y):y=e[13],y}function gt(n){return!n}const ne=n=>{const e=se.c(9),{children:l,className:i,tooltipText:a,tooltipAriaLabel:s}=n,x=`text-xs uppercase tracking-[0.3em] text-[#6a5d52] dark:text-white/60 ${i??""}`;let d;e[0]!==l?(d=t.jsx("span",{children:l}),e[0]=l,e[1]=d):d=e[1];let u;e[2]!==s||e[3]!==a?(u=a?t.jsx("span",{className:"ml-2 inline-flex align-middle",children:t.jsx(bt,{text:a,ariaLabel:s??"Дополнительная информация"})}):null,e[2]=s,e[3]=a,e[4]=u):u=e[4];let o;return e[5]!==x||e[6]!==d||e[7]!==u?(o=t.jsxs("div",{className:x,children:[d,u]}),e[5]=x,e[6]=d,e[7]=u,e[8]=o):o=e[8],o},Te=n=>{const e=se.c(3),{children:l,className:i}=n,a=`font-display text-2xl ${i??""}`;let s;return e[0]!==l||e[1]!==a?(s=t.jsx("div",{className:a,children:l}),e[0]=l,e[1]=a,e[2]=s):s=e[2],s},wt=n=>({"--delay":`${n}ms`}),yt={id:0,startDate:"",endDate:"",incomes:[],expenses:[],offIncomeExpenses:[],dailyExpenses:{},isPinned:!1,isClosed:!1},Z=n=>`${Math.max(0,Math.round(n)).toLocaleString("ru-RU")} ₽`,we=n=>{const e=Math.round(n);return e===0?"0 ₽":`${e>0?"+":"−"}${Math.abs(e).toLocaleString("ru-RU")} ₽`},re=n=>{const[e,l,i]=n.split("-").map(Number);return new Date(e,(l??1)-1,i??1)},be=n=>{const e=re(n),l=String(e.getDate()).padStart(2,"0"),i=String(e.getMonth()+1).padStart(2,"0");return`${l}.${i}`},kt=n=>new Intl.DateTimeFormat("ru-RU",{month:"long",year:"numeric"}).format(re(n)),Ve=(n,e)=>{if(!n)return"";const[l,i,a]=n.split("-").map(Number);if(!l||!i||!a)return"";const s=i-1+e,x=l+Math.floor(s/12),d=(s%12+12)%12,u=new Date(x,d+1,0).getDate(),o=Math.min(a,u),p=String(d+1).padStart(2,"0"),b=String(o).padStart(2,"0");return`${x}-${p}-${b}`},ze=(n,e)=>{const l=new Intl.DateTimeFormat("ru-RU",{month:"short"}),i=l.format(re(n)),a=l.format(re(e)),s=re(n).getFullYear(),x=re(e).getFullYear();return s===x?i===a?kt(n):`${i}–${a} ${s}`:`${i} ${s} – ${a} ${x}`},Ye=(n,e)=>{const l=re(n),a=re(e).getTime()-l.getTime(),s=Math.floor(a/(1e3*60*60*24));return Math.max(1,s+1)},jt=n=>{const e=n.getFullYear(),l=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0");return`${e}-${l}-${i}`},ye=n=>{const e=n.replace(/\D/g,"");return e===""?"":Number(e)},Ke=n=>n.filter(e=>e.name.trim()==="").map(e=>e.id),qe=n=>{const e=se.c(3),{children:l,className:i}=n,a=`flex flex-wrap items-center gap-2 text-xs font-semibold sm:text-sm ${i??""}`;let s;return e[0]!==l||e[1]!==a?(s=t.jsx("div",{className:a,children:l}),e[0]=l,e[1]=a,e[2]=s):s=e[2],s},fe=n=>{const e=se.c(3),{children:l,className:i}=n,a=`inline-flex items-center font-display tabular-nums leading-[0.9] ${i??""}`;let s;return e[0]!==l||e[1]!==a?(s=t.jsx("span",{className:a,children:l}),e[0]=l,e[1]=a,e[2]=s):s=e[2],s},De=n=>{const e=se.c(3),{children:l,className:i}=n,a=`inline-flex items-center leading-[0.9] relative -top-[1px] text-black/50 dark:text-white/60 ${i??""}`;let s;return e[0]!==l||e[1]!==a?(s=t.jsx("span",{className:a,children:l}),e[0]=l,e[1]=a,e[2]=s):s=e[2],s},Nt=n=>{const e=se.c(27),{items:l,setItems:i,totalAmount:a,onAdd:s,onBlurField:x,invalidNameIds:d,readOnly:u}=n,o=u===void 0?!1:u;let p;e[0]===Symbol.for("react.memo_cache_sentinel")?(p=t.jsx(ne,{children:"Приход"}),e[0]=p):p=e[0];let b;e[1]!==s||e[2]!==o?(b=t.jsxs("div",{className:"flex items-center justify-between",children:[p,t.jsx(X,{type:"button",onClick:s,disabled:o,children:"+ Строка"})]}),e[1]=s,e[2]=o,e[3]=b):b=e[3];let g;e[4]===Symbol.for("react.memo_cache_sentinel")?(g=t.jsxs("div",{className:"mt-3 hidden grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)] items-center gap-2 text-[11px] uppercase tracking-[0.2em] text-[#6a5d52] dark:text-white/60 sm:grid",children:[t.jsx("span",{children:"Название"}),t.jsx("span",{className:"text-right",children:"Сумма"})]}),e[4]=g):g=e[4];let c;if(e[5]!==d||e[6]!==l||e[7]!==x||e[8]!==o||e[9]!==i){let I;e[11]!==d||e[12]!==x||e[13]!==o||e[14]!==i?(I=(D,z)=>t.jsxs("div",{className:"grid items-center gap-2 grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)]",children:[t.jsx("input",{type:"text",placeholder:`Приход ${z+1}`,value:D.name,disabled:o,onChange:F=>i(j=>j.map(T=>T.id===D.id?{...T,name:F.target.value}:T)),onBlur:x,className:`rounded-lg border bg-white/90 px-3 py-2 text-xs dark:bg-white/10 sm:px-4 sm:text-sm ${d.includes(D.id)?"border-[#b0352b] dark:border-[#ff8b7c]":"border-black/10 dark:border-white/10"}`}),t.jsx("input",{type:"number",min:0,step:1,inputMode:"numeric",value:D.amount,disabled:o,onChange:F=>{const j=F.target.value;i(T=>T.map(C=>C.id===D.id?{...C,amount:ye(j)}:C))},onFocus:()=>{D.amount===0&&i(F=>F.map(j=>j.id===D.id?{...j,amount:""}:j))},onBlur:()=>{D.amount===""&&i(F=>F.map(j=>j.id===D.id?{...j,amount:0}:j)),x()},className:"no-spin rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs text-right tabular-nums dark:border-white/10 dark:bg-white/10 sm:px-4 sm:text-sm"})]},D.id),e[11]=d,e[12]=x,e[13]=o,e[14]=i,e[15]=I):I=e[15],c=l.map(I),e[5]=d,e[6]=l,e[7]=x,e[8]=o,e[9]=i,e[10]=c}else c=e[10];let v;e[16]!==c?(v=t.jsx("div",{className:"mt-3 grid gap-2",children:c}),e[16]=c,e[17]=v):v=e[17];let h;e[18]===Symbol.for("react.memo_cache_sentinel")?(h=t.jsx("span",{children:"Итого прихода"}),e[18]=h):h=e[18];let y;e[19]!==a?(y=Z(a),e[19]=a,e[20]=y):y=e[20];let k;e[21]!==y?(k=t.jsxs("div",{className:"mt-3 grid items-center gap-2 rounded-lg border border-dashed border-black/10 bg-white/70 px-4 py-2 text-xs dark:border-white/10 dark:bg-white/5 grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)]",children:[h,t.jsx("span",{className:"text-right font-display text-sm tabular-nums",children:y})]}),e[21]=y,e[22]=k):k=e[22];let S;return e[23]!==b||e[24]!==v||e[25]!==k?(S=t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/80 px-5 py-4 text-sm shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-white/10",children:[b,g,v,k]}),e[23]=b,e[24]=v,e[25]=k,e[26]=S):S=e[26],S},vt=n=>{const e=se.c(71),{title:l,items:i,setItems:a,showDelete:s,onToggleDelete:x,totalLabel:d,totalPlanned:u,totalActual:o,totalDifference:p,idPrefix:b,onBlurField:g,onAfterDelete:c,readOnly:v}=n,h=v===void 0?!1:v;let y;e[0]!==l?(y=t.jsx(ne,{children:l}),e[0]=l,e[1]=y):y=e[1];let k;e[2]!==b||e[3]!==a?(k=()=>a(ce=>[...ce,{id:`${b}${Date.now()}`,name:"",plannedAmount:"",actualAmount:"",actualTouched:!1}]),e[2]=b,e[3]=a,e[4]=k):k=e[4];let S;e[5]!==h||e[6]!==k?(S=t.jsx(X,{type:"button",onClick:k,disabled:h,children:"+ Строка"}),e[5]=h,e[6]=k,e[7]=S):S=e[7];let I;e[8]!==x||e[9]!==h||e[10]!==s?(I=t.jsx(X,{type:"button",onClick:x,active:s,activeTone:"danger",disabled:h,children:"− Удаление"}),e[8]=x,e[9]=h,e[10]=s,e[11]=I):I=e[11];let D;e[12]!==S||e[13]!==I?(D=t.jsxs("div",{className:"flex items-center gap-2",children:[S,I]}),e[12]=S,e[13]=I,e[14]=D):D=e[14];let z;e[15]!==y||e[16]!==D?(z=t.jsxs("div",{className:"flex items-center justify-between",children:[y,D]}),e[15]=y,e[16]=D,e[17]=z):z=e[17];const F=`mt-3 grid items-center gap-2 text-[11px] uppercase tracking-[0.2em] text-[#6a5d52] dark:text-white/60 ${s?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_minmax(0,0.7fr)]"}`;let j,T,C;e[18]===Symbol.for("react.memo_cache_sentinel")?(C=t.jsxs("span",{children:[t.jsx("span",{className:"sm:hidden",children:"Название"}),t.jsx("span",{className:"hidden sm:inline",children:"Название"})]}),j=t.jsx("span",{className:"text-right",children:"План"}),T=t.jsx("span",{className:"text-right",children:"Факт"}),e[18]=j,e[19]=T,e[20]=C):(j=e[18],T=e[19],C=e[20]);let H;e[21]===Symbol.for("react.memo_cache_sentinel")?(H=t.jsxs("span",{className:"text-right",children:[t.jsx("span",{className:"sm:hidden",children:"Разн"}),t.jsx("span",{className:"hidden sm:inline",children:"Разница"})]}),e[21]=H):H=e[21];let Q;e[22]!==s?(Q=s&&t.jsx("span",{className:"text-center",children:"—"}),e[22]=s,e[23]=Q):Q=e[23];let L;e[24]!==Q||e[25]!==F?(L=t.jsxs("div",{className:F,children:[C,j,T,H,Q]}),e[24]=Q,e[25]=F,e[26]=L):L=e[26];let B;if(e[27]!==i||e[28]!==c||e[29]!==g||e[30]!==h||e[31]!==a||e[32]!==s){let ce;e[34]!==c||e[35]!==g||e[36]!==h||e[37]!==a||e[38]!==s?(ce=(_,ke)=>t.jsxs("div",{className:`grid items-center gap-2 ${s?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_minmax(0,0.7fr)]"}`,children:[t.jsx("input",{type:"text",placeholder:`Трата ${ke+1}`,value:_.name,disabled:h,onChange:O=>a(N=>N.map(ae=>ae.id===_.id?{...ae,name:O.target.value}:ae)),onBlur:g,className:"rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs dark:border-white/10 dark:bg-white/10 sm:px-4 sm:text-sm"}),t.jsx("input",{type:"number",min:0,step:1,inputMode:"numeric",value:_.plannedAmount,disabled:h,onChange:O=>{const N=O.target.value;a(ae=>ae.map(te=>te.id===_.id?{...te,plannedAmount:ye(N),actualAmount:te.actualTouched?te.actualAmount:ye(N)}:te))},onFocus:()=>{_.plannedAmount===0&&a(O=>O.map(N=>N.id===_.id?{...N,plannedAmount:""}:N))},onBlur:()=>{_.plannedAmount===""&&a(O=>O.map(N=>N.id===_.id?{...N,plannedAmount:0}:N)),g()},className:"no-spin rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs text-right tabular-nums dark:border-white/10 dark:bg-white/10 sm:px-4 sm:text-sm"}),t.jsx("input",{type:"number",min:0,step:1,inputMode:"numeric",value:_.actualAmount,disabled:h,onChange:O=>{const N=O.target.value;a(ae=>ae.map(te=>te.id===_.id?{...te,actualAmount:ye(N),actualTouched:!0}:te))},onFocus:()=>{_.actualAmount===0&&a(O=>O.map(N=>N.id===_.id?{...N,actualAmount:""}:N))},onBlur:()=>{_.actualAmount===""&&a(O=>O.map(N=>N.id===_.id?{...N,actualAmount:0}:N)),g()},className:"no-spin rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs text-right tabular-nums dark:border-white/10 dark:bg-white/10 sm:px-4 sm:text-sm"}),t.jsx("div",{className:`flex min-h-[36px] items-center justify-end px-0 py-2 text-xs tabular-nums sm:min-h-[40px] sm:px-4 sm:text-sm ${_.plannedAmount-_.actualAmount>0?"text-[#1e7b4f] dark:text-[#7ce0b3]":_.plannedAmount-_.actualAmount<0?"text-[#b0352b] dark:text-[#ff8b7c]":"text-[#6a5d52] dark:text-white/70"}`,children:we(_.plannedAmount-_.actualAmount)}),s&&t.jsx("button",{type:"button",onClick:()=>{window.confirm("Удалить строку?")&&(a(O=>O.filter(N=>N.id!==_.id)),c())},"aria-label":`Удалить трату ${ke+1}`,className:"flex h-8 w-8 items-center justify-center rounded-full text-xs text-[#b0352b] transition hover:bg-[#b0352b]/10 dark:text-[#ff8b7c] dark:hover:bg-[#ff8b7c]/15",disabled:h,children:"—"})]},_.id),e[34]=c,e[35]=g,e[36]=h,e[37]=a,e[38]=s,e[39]=ce):ce=e[39],B=i.map(ce),e[27]=i,e[28]=c,e[29]=g,e[30]=h,e[31]=a,e[32]=s,e[33]=B}else B=e[33];let A;e[40]!==B?(A=t.jsx("div",{className:"mt-3 grid gap-2",children:B}),e[40]=B,e[41]=A):A=e[41];const ee=`mt-3 grid items-center gap-2 rounded-lg border border-dashed border-black/10 bg-white/70 px-4 py-2 text-xs dark:border-white/10 dark:bg-white/5 ${s?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_minmax(0,0.7fr)]"}`;let Y;e[42]!==d?(Y=t.jsx("span",{children:d}),e[42]=d,e[43]=Y):Y=e[43];let J;e[44]!==u?(J=Z(u),e[44]=u,e[45]=J):J=e[45];let K;e[46]!==J?(K=t.jsx("span",{className:"text-right font-display text-sm tabular-nums",children:J}),e[46]=J,e[47]=K):K=e[47];let P;e[48]!==o?(P=Z(o),e[48]=o,e[49]=P):P=e[49];let W;e[50]!==P?(W=t.jsx("span",{className:"text-right font-display text-sm tabular-nums",children:P}),e[50]=P,e[51]=W):W=e[51];const V=`text-right font-display text-sm tabular-nums ${p>0?"text-[#1e7b4f] dark:text-[#7ce0b3]":p<0?"text-[#b0352b] dark:text-[#ff8b7c]":"text-[#6a5d52] dark:text-white/70"}`;let E;e[52]!==p?(E=we(p),e[52]=p,e[53]=E):E=e[53];let q;e[54]!==V||e[55]!==E?(q=t.jsx("span",{className:V,children:E}),e[54]=V,e[55]=E,e[56]=q):q=e[56];let G;e[57]!==s?(G=s&&t.jsx("span",{}),e[57]=s,e[58]=G):G=e[58];let oe;e[59]!==ee||e[60]!==Y||e[61]!==K||e[62]!==W||e[63]!==q||e[64]!==G?(oe=t.jsxs("div",{className:ee,children:[Y,K,W,q,G]}),e[59]=ee,e[60]=Y,e[61]=K,e[62]=W,e[63]=q,e[64]=G,e[65]=oe):oe=e[65];let le;return e[66]!==L||e[67]!==A||e[68]!==oe||e[69]!==z?(le=t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/80 px-5 py-4 text-sm shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-white/10",children:[z,L,A,oe]}),e[66]=L,e[67]=A,e[68]=oe,e[69]=z,e[70]=le):le=e[70],le},_t=n=>{const e=se.c(58),{title:l,items:i,setItems:a,showDelete:s,onToggleDelete:x,totalLabel:d,totalAmount:u,idPrefix:o,onBlurField:p,onAfterDelete:b,readOnly:g}=n,c=g===void 0?!1:g;let v;e[0]!==l?(v=t.jsx(ne,{tooltipText:"Эти траты не учитываются в расчётах.",tooltipAriaLabel:"Сторонние траты",children:l}),e[0]=l,e[1]=v):v=e[1];let h;e[2]!==o||e[3]!==a?(h=()=>a(K=>[...K,{id:`${o}${Date.now()}`,name:"",amount:""}]),e[2]=o,e[3]=a,e[4]=h):h=e[4];let y;e[5]!==c||e[6]!==h?(y=t.jsx(X,{type:"button",onClick:h,disabled:c,children:"+ Строка"}),e[5]=c,e[6]=h,e[7]=y):y=e[7];let k;e[8]!==x||e[9]!==c||e[10]!==s?(k=t.jsx(X,{type:"button",onClick:x,active:s,activeTone:"danger",disabled:c,children:"− Удаление"}),e[8]=x,e[9]=c,e[10]=s,e[11]=k):k=e[11];let S;e[12]!==y||e[13]!==k?(S=t.jsxs("div",{className:"flex items-center gap-2",children:[y,k]}),e[12]=y,e[13]=k,e[14]=S):S=e[14];let I;e[15]!==v||e[16]!==S?(I=t.jsxs("div",{className:"flex items-center justify-between",children:[v,S]}),e[15]=v,e[16]=S,e[17]=I):I=e[17];const D=`mt-3 hidden items-center gap-2 text-[11px] uppercase tracking-[0.2em] text-[#6a5d52] dark:text-white/60 sm:grid ${s?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)]"}`;let z,F;e[18]===Symbol.for("react.memo_cache_sentinel")?(F=t.jsx("span",{children:"Название"}),z=t.jsx("span",{className:"text-right",children:"Сумма"}),e[18]=z,e[19]=F):(z=e[18],F=e[19]);let j;e[20]!==s?(j=s&&t.jsx("span",{className:"text-center",children:"—"}),e[20]=s,e[21]=j):j=e[21];let T;e[22]!==j||e[23]!==D?(T=t.jsxs("div",{className:D,children:[F,z,j]}),e[22]=j,e[23]=D,e[24]=T):T=e[24];let C;if(e[25]!==i||e[26]!==b||e[27]!==p||e[28]!==c||e[29]!==a||e[30]!==s){let K;e[32]!==b||e[33]!==p||e[34]!==c||e[35]!==a||e[36]!==s?(K=(P,W)=>t.jsxs("div",{className:`grid items-center gap-2 ${s?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)]"}`,children:[t.jsx("input",{type:"text",placeholder:`Трата ${W+1}`,value:P.name,disabled:c,onChange:V=>a(E=>E.map(q=>q.id===P.id?{...q,name:V.target.value}:q)),onBlur:p,className:"rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs dark:border-white/10 dark:bg-white/10 sm:px-4 sm:text-sm"}),t.jsx("input",{type:"number",min:0,step:1,inputMode:"numeric",value:P.amount,disabled:c,onChange:V=>{const E=V.target.value;a(q=>q.map(G=>G.id===P.id?{...G,amount:ye(E)}:G))},onFocus:()=>{P.amount===0&&a(V=>V.map(E=>E.id===P.id?{...E,amount:""}:E))},onBlur:()=>{P.amount===""&&a(V=>V.map(E=>E.id===P.id?{...E,amount:0}:E)),p()},className:"no-spin rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs text-right tabular-nums text-[#b0352b] dark:border-white/10 dark:bg-white/10 dark:text-[#ff8b7c] sm:px-4 sm:text-sm"}),s&&t.jsx("button",{type:"button",onClick:()=>{window.confirm("Удалить строку?")&&(a(V=>V.filter(E=>E.id!==P.id)),b())},"aria-label":`Удалить трату ${W+1}`,className:"flex h-8 w-8 items-center justify-center rounded-full text-xs text-[#b0352b] transition hover:bg-[#b0352b]/10 dark:text-[#ff8b7c] dark:hover:bg-[#ff8b7c]/15",disabled:c,children:"—"})]},P.id),e[32]=b,e[33]=p,e[34]=c,e[35]=a,e[36]=s,e[37]=K):K=e[37],C=i.map(K),e[25]=i,e[26]=b,e[27]=p,e[28]=c,e[29]=a,e[30]=s,e[31]=C}else C=e[31];let H;e[38]!==C?(H=t.jsx("div",{className:"mt-3 grid gap-2",children:C}),e[38]=C,e[39]=H):H=e[39];const Q=`mt-3 grid items-center gap-2 rounded-lg border border-dashed border-black/10 bg-white/70 px-4 py-2 text-xs dark:border-white/10 dark:bg-white/5 ${s?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)]"}`;let L;e[40]!==d?(L=t.jsx("span",{children:d}),e[40]=d,e[41]=L):L=e[41];let B;e[42]!==u?(B=Z(u),e[42]=u,e[43]=B):B=e[43];let A;e[44]!==B?(A=t.jsx("span",{className:"text-right font-display text-sm tabular-nums text-[#b0352b] dark:text-[#ff8b7c]",children:B}),e[44]=B,e[45]=A):A=e[45];let ee;e[46]!==s?(ee=s&&t.jsx("span",{}),e[46]=s,e[47]=ee):ee=e[47];let Y;e[48]!==Q||e[49]!==L||e[50]!==A||e[51]!==ee?(Y=t.jsxs("div",{className:Q,children:[L,A,ee]}),e[48]=Q,e[49]=L,e[50]=A,e[51]=ee,e[52]=Y):Y=e[52];let J;return e[53]!==T||e[54]!==H||e[55]!==Y||e[56]!==I?(J=t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/80 px-5 py-4 text-sm shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-white/10",children:[I,T,H,Y]}),e[53]=T,e[54]=H,e[55]=Y,e[56]=I,e[57]=J):J=e[57],J};function Pt(){const{periodId:n}=rt().props,[e,l]=m.useState(yt),[i,a]=m.useState([]),[s,x]=m.useState(""),[d,u]=m.useState(""),[o,p]=m.useState([]),[b,g]=m.useState([]),[c,v]=m.useState({}),[h,y]=m.useState(!1),[k,S]=m.useState(!1),[I,D]=m.useState(!0),[z,F]=m.useState(null),[j,T]=m.useState(!1),[C,H]=m.useState(null),[Q,L]=m.useState(!1),[B,A]=m.useState(null),[ee,Y]=m.useState(!1),[J,K]=m.useState([]),[P,W]=m.useState(!1),[V,E]=m.useState(!1),[q,G]=m.useState(!1),[oe,le]=m.useState(!1),[ce,_]=m.useState(!1),[ke,O]=m.useState(),N=m.useRef(!1),[ae,te]=m.useState(0),Pe="Заполните названия прихода.",pe=m.useRef(null),je=m.useRef(null),Me=m.useMemo(()=>`period:${n}`,[n]),Se=m.useRef(!1),Ce=m.useRef(!1),Ue=()=>typeof window>"u"?null:window.__periodCache?.[Me]??null,Ne=r=>{if(typeof window>"u")return;const f=window;f.__periodCache||(f.__periodCache={}),f.__periodCache[Me]=r},ve=(o??[]).reduce((r,f)=>r+(Number(f.plannedAmount)||0),0),Fe=(o??[]).reduce((r,f)=>r+(Number(f.actualAmount)||0),0),xe=ve-Fe,He=(b??[]).reduce((r,f)=>r+(Number(f.amount)||0),0),$e=(i??[]).reduce((r,f)=>r+(Number(f.amount)||0),0),me=m.useMemo(()=>!s||!d?0:Ye(s,d),[s,d]),ge=m.useMemo(()=>Object.values(c).reduce((r,f)=>r+(f||0),0),[c]),_e=m.useMemo(()=>{if(!s||!d)return 0;const r=re(s),f=re(d);if(!Number.isFinite(r.getTime())||!Number.isFinite(f.getTime()))return 0;let U=0;const $=new Date(r);for(;$<=f;){const R=jt($);c[R]!==void 0&&(U+=1),$.setDate($.getDate()+1)}return U},[c,s,d]),Xe=_e>0?ge/_e:0,Ae=m.useMemo(()=>!s||!d?"Период":`${be(s)} — ${be(d)}`,[s,d]),Je=m.useMemo(()=>!s||!d?"":`${me} дней · ${ze(s,d)}`,[me,s,d]),ue=$e-ve,Ge=me>0?ue/me:0,Oe=ue+xe-ge,Ee=Math.max(0,me-_e),Qe=Ee>0?Oe/Ee:0,We=me>0&&_e>=me,he=e.isClosed,Ze=[{title:"Dashboard",href:Ie().url},{title:Ae,href:`/periods/${n}`}],et=r=>!!(r&&r.id&&Array.isArray(r.incomes)&&Array.isArray(r.expenses)&&Array.isArray(r.offIncomeExpenses)),tt=async()=>{if(Ce.current)return;const r=Ue();if(!(et(r)&&(l({...r,isClosed:!!r.isClosed}),a(r.incomes??[]),x(r.startDate??""),u(r.endDate??""),p(r.expenses??[]),g(r.offIncomeExpenses??[]),v(r.dailyExpenses??{}),pe.current={startDate:r.startDate??"",endDate:r.endDate??""},D(!1),typeof navigator<"u"&&!navigator.onLine))&&!(Se.current&&(!navigator.onLine||!r))){Ce.current=!0,D(!0),F(null);try{const f=await fetch(`/api/periods/${n}`);if(!f.ok)throw new Error("Не удалось загрузить период.");const $=(await f.json()).data,R={id:$.id,startDate:$.start_date,endDate:$.end_date,dailyExpenses:$.daily_expenses??{},isPinned:!!$.is_pinned,isClosed:!!$.is_closed,incomes:$.incomes.map(M=>({id:String(M.id),name:M.name,amount:M.amount})),expenses:$.expenses.map(M=>({id:String(M.id),name:M.name,plannedAmount:M.planned_amount,actualAmount:M.actual_amount,actualTouched:!1})),offIncomeExpenses:$.external_expenses.map(M=>({id:String(M.id),name:M.name,amount:M.amount}))};l(R),a(R.incomes),x(R.startDate),u(R.endDate),p(R.expenses),g(R.offIncomeExpenses),v(R.dailyExpenses),le(!1),O(void 0),pe.current={startDate:R.startDate,endDate:R.endDate},Ne(R),Se.current=!0}catch(f){F(f instanceof Error?f.message:"Не удалось загрузить период.")}finally{D(!1),Ce.current=!1}}},ie=async(r=!1,f)=>{if(e.isClosed)return;const U=f?.startDate??s,$=f?.endDate??d,R=Ke(i);if(R.length>0){K(R),A(Pe);return}if(j){N.current=!0;return}T(!0),A(null),Y(!1);try{const M=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")??"",de=await fetch(`/api/periods/${n}`,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":M},body:JSON.stringify({start_date:U,end_date:$,daily_expenses:c,force:r,incomes:i.filter(w=>w.name.trim()!==""&&w.amount!=="").map(w=>({id:Number.isFinite(Number(w.id))?Number(w.id):void 0,name:w.name,amount:Number(w.amount)})),expenses:o.filter(w=>w.name.trim()!==""&&w.plannedAmount!==""&&w.actualAmount!=="").map(w=>({id:Number.isFinite(Number(w.id))?Number(w.id):void 0,name:w.name,planned_amount:Number(w.plannedAmount),actual_amount:Number(w.actualAmount)})),external_expenses:b.filter(w=>w.name.trim()!==""&&w.amount!=="").map(w=>({id:Number.isFinite(Number(w.id))?Number(w.id):void 0,name:w.name,amount:Number(w.amount)}))})});if(de.status===409){const w=await de.json();if(w.overlap){je.current={startDate:U,endDate:$},H(w.overlap),L(!0),pe.current&&(x(pe.current.startDate),u(pe.current.endDate));return}throw new Error("Период пересекается с существующим.")}if(!de.ok){if(de.status===423){const w=await de.json();throw new Error(w.message??"Период закрыт и не редактируется.")}throw new Error("Не удалось сохранить период.")}x(U),u($),Y(!0),H(null),L(!1),je.current=null,pe.current={startDate:U,endDate:$},Ne({id:Number(n),startDate:U,endDate:$,incomes:i,expenses:o,offIncomeExpenses:b,dailyExpenses:c,isPinned:e.isPinned,isClosed:e.isClosed})}catch(M){A(M instanceof Error?M.message:"Не удалось сохранить период.")}finally{T(!1)}},st=()=>{e.isClosed||(a(r=>[...r,{id:`i${Date.now()}`,name:"",amount:""}]),ie())},Re=()=>{te(r=>r+1)},at=async()=>{if(!P&&window.confirm("Удалить период?")){W(!0),A(null);try{const r=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")??"";if(!(await fetch(`/api/periods/${n}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":r}})).ok)throw new Error("Не удалось удалить период.");window.location.href=Ie().url}catch(r){A(r instanceof Error?r.message:"Не удалось удалить период.")}finally{W(!1)}}},nt=async()=>{if(!(q||e.isClosed)){G(!0),A(null);try{const r=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")??"",f=await fetch(`/api/periods/${n}/close`,{method:"POST",headers:{"X-CSRF-TOKEN":r}});if(!f.ok){const R=await f.json();throw new Error(R.message??"Не удалось закрыть период.")}const U=await f.json(),$={...e,isClosed:U.data?.is_closed??!0};l($),_(!1),Ne({id:Number(n),startDate:s,endDate:d,incomes:i,expenses:o,offIncomeExpenses:b,dailyExpenses:c,isPinned:e.isPinned,isClosed:$.isClosed})}catch(r){A(r instanceof Error?r.message:"Не удалось закрыть период.")}finally{G(!1)}}},Be=async(r=!1)=>{if(!V){E(!0);try{const f=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")??"",U=await fetch(`/api/periods/${n}/pin`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":f},body:JSON.stringify({pinned:!e.isPinned,force:r})});if(U.status===409){const de=await U.json();de.pinned?O(`${be(de.pinned.start_date)} — ${be(de.pinned.end_date)}`):O(void 0),le(!0);return}if(!U.ok)throw new Error("Не удалось изменить закрепление периода.");const R=(await U.json()).data?.is_pinned??!e.isPinned,M={...e,isPinned:R};l(M),Ne(M),le(!1)}catch(f){A(f instanceof Error?f.message:"Не удалось изменить закрепление периода.")}finally{E(!1)}}};return m.useEffect(()=>{Se.current=!1,tt()},[n]),m.useEffect(()=>{!j&&N.current&&(N.current=!1,ie())},[j]),m.useEffect(()=>{ae>0&&ie()},[ae]),m.useEffect(()=>{const r=Ke(i);K(r),r.length===0&&B===Pe&&A(null)},[i,B]),t.jsxs(ct,{breadcrumbs:Ze,children:[t.jsx(lt,{title:Ae}),t.jsxs("div",{className:`relative flex flex-1 flex-col gap-8 overflow-x-hidden rounded-xl p-3 font-body text-[#1c1a17] dark:text-[#f7f3ee]${e.isClosed?" bg-emerald-50/70 dark:bg-emerald-950/20":""}`,children:[t.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-3xl bg-aurora opacity-35 dark:hidden"}),t.jsx("div",{className:"pointer-events-none absolute inset-0 hidden rounded-3xl bg-aurora-night opacity-45 dark:block"}),t.jsxs("section",{className:"relative z-10 flex flex-wrap items-center justify-between gap-6",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-[#6a5d52] dark:text-white/60",children:"Период"}),t.jsx("h1",{className:"mt-3 font-display text-3xl",children:Ae}),t.jsx("p",{className:"mt-2 text-sm text-[#6a5d52] dark:text-white/70",children:Je})]}),e.isClosed&&t.jsx("div",{className:"flex-1 text-center text-sm font-semibold text-emerald-600 dark:text-emerald-300",children:"Период закрыт"}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[!e.isClosed&&t.jsx(X,{type:"button",onClick:()=>Be(!1),tone:e.isPinned?"danger":"success",disabled:V,className:"px-4 py-2",children:e.isPinned?"Открепить":"Закрепить"}),We&&!e.isClosed&&t.jsx(X,{type:"button",onClick:()=>_(!0),disabled:q,tone:"success",className:"px-4 py-2",children:"Закрыть период"}),t.jsx(X,{type:"button",onClick:at,disabled:P,tone:"danger",className:"px-4 py-2",children:"Удалить"}),t.jsx(Le,{href:Ie(),prefetch:!0,className:"rounded-full border border-black/10 bg-white/80 px-4 py-2 text-xs text-[#1c1a17] shadow-[0_16px_32px_-24px_rgba(28,26,23,0.6)] transition hover:-translate-y-0.5 dark:border-white/10 dark:bg-white/10 dark:text-white",children:"← Ко всем периодам"})]})]}),t.jsxs("section",{className:"relative z-10 grid gap-6 lg:grid-cols-[1.1fr_0.9fr] lg:items-start animate-reveal",style:wt(120),children:[I&&t.jsx("div",{className:"col-span-full rounded-lg border border-black/10 bg-white/70 px-5 py-4 text-sm text-[#6a5d52] dark:border-white/10 dark:bg-white/10 dark:text-white/70",children:"Загружаем период..."}),z&&t.jsx("div",{className:"col-span-full rounded-lg border border-black/10 bg-white/70 px-5 py-4 text-sm text-[#b0352b] dark:border-white/10 dark:bg-white/10 dark:text-[#ff8b7c]",children:z}),t.jsxs("div",{className:"order-2 grid gap-4 lg:order-none lg:self-start",children:[t.jsx(Nt,{items:i,setItems:a,totalAmount:$e,onAdd:st,onBlurField:ie,invalidNameIds:J,readOnly:he}),t.jsx(vt,{title:"Обязательные траты",items:o,setItems:p,showDelete:h,onToggleDelete:()=>y(r=>!r),totalLabel:"Итого обязательных",totalPlanned:ve,totalActual:Fe,totalDifference:xe,idPrefix:"e",onBlurField:ie,onAfterDelete:Re,readOnly:he}),t.jsx(_t,{title:"Сторонние траты",items:b,setItems:g,showDelete:h,onToggleDelete:()=>y(r=>!r),totalLabel:"Итого сторонних",totalAmount:He,idPrefix:"o",onBlurField:ie,onAfterDelete:Re,readOnly:he})]}),t.jsxs("div",{className:"order-1 grid gap-4 lg:order-none lg:self-start",children:[t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/80 px-5 py-4 text-sm shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-white/10",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(ne,{children:"Дни периода"}),t.jsx(X,{type:"button",onClick:()=>S(r=>!r),active:k,activeTone:"success",disabled:he,children:k?"Готово":"Редактировать"})]}),t.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[t.jsx("div",{className:"px-1 text-base font-semibold tabular-nums",children:me}),t.jsx("span",{className:"text-xs text-[#6a5d52] dark:text-white/60",children:"дней"})]}),k&&t.jsxs("div",{className:"mt-3 grid gap-2 grid-cols-2",children:[t.jsxs("label",{className:"grid gap-1 text-xs text-[#6a5d52] dark:text-white/60",children:["Начало",t.jsx("input",{type:"date",value:s,disabled:he,onChange:r=>{const f=r.target.value;x(f),ie(!1,{startDate:f})},min:d?Ve(d,-3):void 0,max:d,className:"rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs dark:border-white/10 dark:bg-white/10 sm:text-sm"})]}),t.jsxs("label",{className:"grid gap-1 text-xs text-[#6a5d52] dark:text-white/60",children:["Конец",t.jsx("input",{type:"date",value:d,disabled:he,onChange:r=>{const f=r.target.value;u(f),ie(!1,{endDate:f})},min:s,max:s?Ve(s,3):void 0,className:"rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs dark:border-white/10 dark:bg-white/10 sm:text-sm"})]})]})]}),t.jsx(Le,{href:`/periods/${n}/daily`,prefetch:!0,className:"group rounded-lg border border-[#1e7b4f]/30 bg-white/90 px-5 py-4 text-sm text-[#1c1a17] shadow-[0_24px_48px_-28px_rgba(30,123,79,0.55)] transition hover:-translate-y-0.5 hover:shadow-[0_28px_60px_-30px_rgba(30,123,79,0.65)] dark:border-[#7ce0b3]/30 dark:bg-white/10 dark:text-white",children:t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsx(ne,{children:"Ежедневные траты"}),t.jsx(X,{as:"span",children:"Перейти к дневным значениям"})]})}),t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/85 px-5 py-6 text-[#1c1a17] shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-[#1c1a17] dark:text-white dark:shadow-[0_20px_40px_-26px_rgba(0,0,0,0.7)]",children:[t.jsx(ne,{children:"Планируемое среднее в день"}),t.jsx("p",{className:"mt-2 text-xs text-[#6a5d52] dark:text-white/60",children:"(Приход − обязательные) / дни"}),t.jsx(Te,{className:"mt-3",children:Z(Ge)}),t.jsxs("div",{className:"mt-4 grid gap-3 text-xs text-[#6a5d52] dark:text-white/70",children:[t.jsx("div",{className:"h-px w-full bg-black/10 dark:bg-white/10"}),t.jsx(ne,{children:"Планируемая сумма на период"}),t.jsxs(qe,{children:[t.jsx(fe,{className:"text-[#1e7b4f] dark:text-[#7ce0b3]",children:Z($e)}),t.jsx(De,{children:"−"}),t.jsx(fe,{className:"text-[#b0352b] dark:text-[#ff8b7c]",children:Z(ve)}),t.jsx(De,{children:"="}),t.jsx(fe,{className:`${ue>=0?"text-[#1e7b4f] dark:text-[#7ce0b3]":"text-[#b0352b] dark:text-[#ff8b7c]"}`,children:we(ue)})]}),t.jsx("div",{className:"text-[11px] uppercase tracking-[0.2em] text-[#6a5d52] dark:text-white/60",children:"Приход − план = сумма в период"})]})]}),t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/85 px-5 py-6 text-[#1c1a17] shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-[#1c1a17] dark:text-white dark:shadow-[0_20px_40px_-26px_rgba(0,0,0,0.7)]",children:[t.jsx(ne,{tooltipText:"Фактический остаток / количество незаполненных (непрошедших) дней",children:"Расчётное в день на оставшиеся дни"}),t.jsxs("p",{className:"mt-2 text-xs text-[#6a5d52] dark:text-white/60",children:["(",Z(Oe)," / ",Ee||0," д.)"]}),t.jsx(Te,{className:"mt-3",children:Z(Qe)})]}),t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/85 px-5 py-6 text-[#1c1a17] shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-[#1c1a17] dark:text-white dark:shadow-[0_20px_40px_-26px_rgba(0,0,0,0.7)]",children:[t.jsx(ne,{tooltipText:"Планируемый остаток +/− фактическая разница − ежедневные траты за период.",tooltipAriaLabel:"Формула фактического остатка",children:"Фактический остаток"}),t.jsxs(qe,{className:"mt-3",children:[t.jsx(fe,{className:"text-[#1e7b4f] dark:text-[#7ce0b3]",children:Z(ue)}),t.jsx(fe,{className:`${xe>0?"text-[#1e7b4f] dark:text-[#7ce0b3]":xe<0?"text-[#b0352b] dark:text-[#ff8b7c]":"text-[#6a5d52] dark:text-white/70"}`,children:we(xe).replace(/^([+−-])/,"$1 ")}),t.jsx(De,{children:"−"}),t.jsx(fe,{className:"text-[#b0352b] dark:text-[#ff8b7c]",children:Z(ge)}),t.jsx(De,{children:"="}),t.jsx(fe,{className:`${ue+xe-ge>=0?"text-[#1e7b4f] dark:text-[#7ce0b3]":"text-[#b0352b] dark:text-[#ff8b7c]"}`,children:we(ue+xe-ge)})]}),t.jsx("div",{className:"mt-4 h-px w-full bg-black/10 dark:bg-white/10"}),t.jsx(ne,{className:"mt-4",children:"Фактическое среднее в день за период"}),t.jsx(Te,{className:"mt-2",children:Z(Xe)})]})]})]}),oe&&t.jsx(pt,{currentTitle:ke,onCancel:()=>le(!1),onConfirm:()=>Be(!0),confirmDisabled:V}),ce&&t.jsx(ht,{onCancel:()=>_(!1),onConfirm:nt,confirmDisabled:q}),C&&t.jsx(mt,{href:`/periods/${C.id}`,title:`${be(C.start_date)} — ${be(C.end_date)}`,subtitle:`${Ye(C.start_date,C.end_date)} дней · ${ze(C.start_date,C.end_date)}`,onClose:()=>{H(null),L(!1),je.current=null},onConfirm:()=>ie(!0,je.current??void 0),confirmDisabled:!Q||j}),B&&t.jsx("div",{className:"relative z-10 rounded-lg border border-black/10 bg-white/70 px-5 py-3 text-xs text-[#b0352b] dark:border-white/10 dark:bg-white/10 dark:text-[#ff8b7c]",children:B})]})]})}export{Pt as default};
