import{c as _e,r as u,j as d,b as Te}from"./app-Cs7KdXzy.js";const I=10,me=80,de=90,ue=(r,e,t)=>Math.max(e,Math.min(t,r)),ge=r=>{const e=r.getBoundingClientRect();return{top:Math.max(0,e.top-I),left:Math.max(0,e.left-I),width:e.width+I*2,height:e.height+I*2,right:e.right+I,bottom:e.bottom+I}},pe=()=>{const r=window.visualViewport;return r?{width:r.width,height:r.height}:{width:window.innerWidth,height:window.innerHeight}},Re=(r,e,t,c)=>{const h=t.width,m=t.height,i=16,T=c.width,l=c.height;if(T<768)return{top:ue(l-m-i,i,l-i),left:i};const ie=e==="top"?"bottom":e==="bottom"?"top":e==="left"?"right":"left",y=x=>x==="top"?{top:r.top-m-i,left:r.left+r.width/2-h/2}:x==="bottom"?{top:r.bottom+i,left:r.left+r.width/2-h/2}:x==="left"?{top:r.top+r.height/2-m/2,left:r.left-h-i}:{top:r.top+r.height/2-m/2,left:r.right+i};let p=y(e);return(p.top<i||p.left<i||p.top+m>l-i||p.left+h>T-i)&&(p=y(ie)),{top:ue(p.top,i,Math.max(i,l-m-i)),left:ue(p.left,i,Math.max(i,T-h-i))}};function Ce(r){const e=_e.c(111),{open:t,steps:c,onClose:h,refreshKey:m}=r,[i,T]=u.useState(0),[,l]=u.useState(0),[a,ie]=u.useState(ze);let y;e[0]===Symbol.for("react.memo_cache_sentinel")?(y={width:360,height:180},e[0]=y):y=e[0];const[p,he]=u.useState(y),[x,N]=u.useState(!1),[xe,fe]=u.useState(null),oe=u.useRef(null),re=u.useId();let A;if(e[1]!==re){let o;e[3]===Symbol.for("react.memo_cache_sentinel")?(o=/[:]/g,e[3]=o):o=e[3],A=re.replace(o,"_"),e[1]=re,e[2]=A}else A=e[2];const L=A,n=c[i]??null,E=n?.targetRef.current,w=t&&x?xe:null;let S;e[4]!==x||e[5]!==t||e[6]!==E?(S=()=>{if(!t||!x||!E){const g=window.setTimeout(()=>{fe(null)},0);return()=>window.clearTimeout(g)}const o=()=>{fe(ge(E))},s=window.setTimeout(o,0),f=window.requestAnimationFrame(o);return()=>{window.clearTimeout(s),window.cancelAnimationFrame(f)}},e[4]=x,e[5]=t,e[6]=E,e[7]=S):S=e[7];let z;e[8]!==x||e[9]!==t||e[10]!==m||e[11]!==E?(z=[t,x,E,m],e[8]=x,e[9]=t,e[10]=m,e[11]=E,e[12]=z):z=e[12],u.useEffect(S,z);let F;e[13]!==n||e[14]!==t||e[15]!==a.width?(F=()=>{if(!t){const M=window.setTimeout(()=>{N(!1)},0);return()=>window.clearTimeout(M)}if(typeof window>"u")return;if(!n?.targetRef.current){const M=window.setTimeout(()=>{N(!1)},0);return()=>window.clearTimeout(M)}if(a.width>=768){const M=window.setTimeout(()=>{N(!0)},0);return()=>window.clearTimeout(M)}const o=window.setTimeout(()=>{N(!1)},0),s=n.targetRef.current,f=()=>{s.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"});const M=s.getBoundingClientRect(),be=window.scrollY+M.top,ve=Math.max(0,be-110-window.innerHeight*.18);window.scrollTo({top:ve,behavior:"smooth"})},g=window.requestAnimationFrame(f),_=window.setTimeout(f,220),we=window.setTimeout(()=>{N(!0)},380);return()=>{window.clearTimeout(o),window.cancelAnimationFrame(g),window.clearTimeout(_),window.clearTimeout(we)}},e[13]=n,e[14]=t,e[15]=a.width,e[16]=F):F=e[16];let C;e[17]!==n||e[18]!==i||e[19]!==t||e[20]!==a.width?(C=[t,i,n,a.width],e[17]=n,e[18]=i,e[19]=t,e[20]=a.width,e[21]=C):C=e[21],u.useEffect(F,C);let O;e[22]!==i||e[23]!==t||e[24]!==l||e[25]!==c?(O=()=>{if(!t)return;let o=0,s=null;const f=()=>{const g=c[i]?.targetRef.current;if(g){const _=ge(g);(!s||Math.abs(_.top-s.top)>.5||Math.abs(_.left-s.left)>.5||Math.abs(_.width-s.width)>.5||Math.abs(_.height-s.height)>.5)&&(s=_,l(Se))}o=window.requestAnimationFrame(f)};return o=window.requestAnimationFrame(f),()=>window.cancelAnimationFrame(o)},e[22]=i,e[23]=t,e[24]=l,e[25]=c,e[26]=O):O=e[26];let V;e[27]!==i||e[28]!==t||e[29]!==c?(V=[t,i,c],e[27]=i,e[28]=t,e[29]=c,e[30]=V):V=e[30],u.useEffect(O,V);let B;e[31]!==n||e[32]!==t||e[33]!==l?(B=()=>{if(!t||!n?.targetRef.current)return;const o=n.targetRef.current,s=new ResizeObserver(()=>{l(Le)});return s.observe(o),()=>s.disconnect()},e[31]=n,e[32]=t,e[33]=l,e[34]=B):B=e[34];let q;e[35]!==n||e[36]!==t?(q=[t,n],e[35]=n,e[36]=t,e[37]=q):q=e[37],u.useEffect(B,q);let D;e[38]!==n||e[39]!==t||e[40]!==l?(D=()=>{if(!t||!n?.targetRef.current)return;const o=n.targetRef.current,s=new MutationObserver(()=>{l(Ae),window.requestAnimationFrame(()=>l(Ne))});return s.observe(o,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),()=>s.disconnect()},e[38]=n,e[39]=t,e[40]=l,e[41]=D):D=e[41];let P;e[42]!==n||e[43]!==t?(P=[t,n],e[42]=n,e[43]=t,e[44]=P):P=e[44],u.useEffect(D,P);let G;e[45]!==n||e[46]!==t||e[47]!==l?(G=()=>{if(!t||!n?.targetRef.current)return;const o=n.targetRef.current,s=()=>{window.setTimeout(()=>l(Ie),0),window.setTimeout(()=>l(ke),120)};return o.addEventListener("click",s),()=>o.removeEventListener("click",s)},e[45]=n,e[46]=t,e[47]=l,e[48]=G):G=e[48];let H;e[49]!==n||e[50]!==t?(H=[t,n],e[49]=n,e[50]=t,e[51]=H):H=e[51],u.useEffect(G,H);let W;e[52]!==t||e[53]!==l?(W=()=>{if(!t)return;const o=window.setTimeout(()=>{l(je)},0),s=window.requestAnimationFrame(()=>l(Me));return()=>{window.clearTimeout(o),window.cancelAnimationFrame(s)}},e[52]=t,e[53]=l,e[54]=W):W=e[54];let $;e[55]!==t||e[56]!==m?($=[t,m],e[55]=t,e[56]=m,e[57]=$):$=e[57],u.useEffect(W,$);let Y;e[58]!==t||e[59]!==l?(Y=()=>{if(!t)return;const o=()=>{ie(pe()),l(Ee)},s=window.visualViewport;return window.addEventListener("resize",o),window.addEventListener("scroll",o,!0),s?.addEventListener("resize",o),s?.addEventListener("scroll",o),()=>{window.removeEventListener("resize",o),window.removeEventListener("scroll",o,!0),s?.removeEventListener("resize",o),s?.removeEventListener("scroll",o)}},e[58]=t,e[59]=l,e[60]=Y):Y=e[60];let Z;e[61]!==t?(Z=[t],e[61]=t,e[62]=Z):Z=e[62],u.useEffect(Y,Z);let K;e[63]!==t?(K=()=>{if(!t||!oe.current)return;const o=oe.current,s=()=>{const g=o.getBoundingClientRect();he({width:g.width,height:g.height})},f=new ResizeObserver(s);return f.observe(o),s(),()=>f.disconnect()},e[63]=t,e[64]=K):K=e[64];let J;e[65]!==n||e[66]!==i||e[67]!==t?(J=[t,i,n],e[65]=n,e[66]=i,e[67]=t,e[68]=J):J=e[68],u.useEffect(K,J);let Q,U;e[69]!==n||e[70]!==i||e[71]!==h||e[72]!==t||e[73]!==c.length?(Q=()=>{if(!t||!n?.captureClick||!n.targetRef.current)return;const o=n.targetRef.current,s=Math.max(0,n.advanceDelayMs??0),f=()=>{window.setTimeout(()=>{if(i===c.length-1){h();return}T(g=>Math.min(g+1,c.length-1))},s)};return o.addEventListener("click",f),()=>o.removeEventListener("click",f)},U=[t,n,i,c.length,h],e[69]=n,e[70]=i,e[71]=h,e[72]=t,e[73]=c.length,e[74]=Q,e[75]=U):(Q=e[74],U=e[75]),u.useEffect(Q,U);const R=n?.nextCondition??!0,se=u.useRef(!1);let X,ee;e[76]!==R||e[77]!==n||e[78]!==i||e[79]!==h||e[80]!==t||e[81]!==c.length?(X=()=>{if(!t||!n){se.current=!1;return}const o=!!n.autoAdvance,s=!se.current&&R;if(se.current=R,!o||!s)return;const f=Math.max(0,n.advanceDelayMs??0),g=window.setTimeout(()=>{if(i===c.length-1){h();return}T(_=>Math.min(_+1,c.length-1))},f>0?f:0);return()=>window.clearTimeout(g)},ee=[t,n,R,i,c.length,h],e[76]=R,e[77]=n,e[78]=i,e[79]=h,e[80]=t,e[81]=c.length,e[82]=X,e[83]=ee):(X=e[82],ee=e[83]),u.useEffect(X,ee);let le;e:{if(!w||!n){le=null;break e}const o=n.placement??"bottom";let s;e[84]!==o||e[85]!==w||e[86]!==p||e[87]!==a?(s=Re(w,o,p,a),e[84]=o,e[85]=w,e[86]=p,e[87]=a,e[88]=s):s=e[88],le=s}const b=le;if(!t||!n)return null;const ce=a.width<768,v=!!(w&&b);let te;e[89]!==v||e[90]!==ce||e[91]!==b?(te=v&&b?ce?{zIndex:de,left:16,right:16,bottom:16}:{zIndex:de,top:b.top,left:b.left}:{},e[89]=v,e[90]=ce,e[91]=b,e[92]=te):te=e[92];const ae=te;let j;e[93]!==v||e[94]!==L||e[95]!==w||e[96]!==a.height||e[97]!==a.width?(j=v?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{className:"pointer-events-none fixed inset-0 h-full w-full",style:{zIndex:me},width:a.width,height:a.height,children:[d.jsx("defs",{children:d.jsxs("mask",{id:L,children:[d.jsx("rect",{x:"0",y:"0",width:a.width,height:a.height,fill:"white"}),d.jsx("rect",{x:w.left,y:w.top,width:w.width,height:w.height,rx:"12",ry:"12",fill:"black"})]})}),d.jsx("rect",{x:"0",y:"0",width:a.width,height:a.height,fill:"rgba(0, 0, 0, 0.42)",mask:`url(#${L})`})]}),d.jsx("div",{className:"pointer-events-none fixed rounded-xl border-2 border-[#b9a6ff] shadow-[0_0_0_2px_rgba(185,166,255,0.45)]",style:{zIndex:de,top:w.top,left:w.left,width:w.width,height:w.height}})]}):d.jsx("div",{className:"pointer-events-none fixed inset-0",style:{zIndex:me,background:"rgba(0, 0, 0, 0.42)"}}),e[93]=v,e[94]=L,e[95]=w,e[96]=a.height,e[97]=a.width,e[98]=j):j=e[98];let k;e[99]!==R||e[100]!==n||e[101]!==v||e[102]!==i||e[103]!==h||e[104]!==c.length||e[105]!==b||e[106]!==ae?(k=v&&b&&d.jsxs("div",{ref:oe,className:"fixed w-[min(360px,calc(100vw-32px))] max-md:w-[calc(100vw-32px)] rounded-2xl border border-white/45 bg-[#1b1227]/90 p-4 text-white shadow-[0_18px_36px_-18px_rgba(0,0,0,0.85)] backdrop-blur-sm",style:ae,children:[d.jsx("div",{className:"mb-2 text-lg leading-none text-[#baa7ff]",children:"↘"}),n.title&&d.jsx("h3",{className:"text-lg font-semibold",children:n.title}),d.jsx("p",{className:"mt-1 text-sm leading-relaxed",children:n.text}),d.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[d.jsxs("span",{className:"text-xs text-white/70",children:[i+1," / ",c.length]}),d.jsxs("div",{className:"flex items-center gap-2",children:[i>0&&d.jsx("button",{type:"button",className:"rounded-lg border border-white/25 px-3 py-1.5 text-xs text-white/90 hover:bg-white/10",onClick:()=>T(ye),children:"Назад"}),!n.hideNext&&d.jsx("button",{type:"button",className:"rounded-lg bg-[#7b67c5] px-3 py-1.5 text-xs font-semibold text-white hover:bg-[#8e79d8] disabled:opacity-50",disabled:!R,onClick:()=>{if(i===c.length-1){h();return}T(o=>Math.min(o+1,c.length-1))},children:"Далее"})]})]})]}),e[99]=R,e[100]=n,e[101]=v,e[102]=i,e[103]=h,e[104]=c.length,e[105]=b,e[106]=ae,e[107]=k):k=e[107];let ne;return e[108]!==j||e[109]!==k?(ne=Te.createPortal(d.jsxs(d.Fragment,{children:[j,k]}),document.body),e[108]=j,e[109]=k,e[110]=ne):ne=e[110],ne}function ye(r){return Math.max(r-1,0)}function Ee(r){return r+1}function Me(r){return r+1}function je(r){return r+1}function ke(r){return r+1}function Ie(r){return r+1}function Ne(r){return r+1}function Ae(r){return r+1}function Le(r){return r+1}function Se(r){return r+1}function ze(){return typeof window>"u"?{width:1280,height:720}:pe()}export{Ce as O};
