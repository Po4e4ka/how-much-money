import{A as D}from"./app-BjXvd9MZ.js";import{o as T,f as w,p as P,g as I,u as O,h as E}from"./onboarding-demo-banner-BDXBAO9f.js";import{p as m,e as y}from"./date-C0FYGyP5.js";const k=e=>`${Math.max(0,Math.round(e)).toLocaleString("ru-RU")} ₽`,U=e=>{const t=Math.round(e);return t===0?"0 ₽":`${t>0?"+":"−"}${Math.abs(t).toLocaleString("ru-RU")} ₽`},W=e=>{const t=e.replace(/\D/g,"");return t===""?"":Number(t)},v=e=>e===""?0:Number(e),p=e=>{const t=e.match(/\/api\/periods\/(\d+)/);if(!t)throw new D("Неверный путь запроса.",400,null);return Number(t[1])},x=e=>{if(!e.body||typeof e.body!="string")return{};try{return JSON.parse(e.body)}catch{return{}}},$=async(e,t={})=>{const a=String(e),[n,r=""]=a.split("?"),o=(t.method??"GET").toUpperCase(),c=x(t);if(n.includes("/expense-suggestions")&&o==="GET"){const s=p(n),d=new URLSearchParams(r).get("type")??"mandatory";return{data:T(s,d)}}if(n.endsWith("/close")&&o==="POST"){const s=p(n);return{data:w(s)}}if(n.endsWith("/pin")&&o==="POST"){const s=p(n);return{data:P(s,!!c.pinned,!!c.force)}}if(n.startsWith("/api/periods/")&&o==="GET"){const s=p(n);return{data:I(s)}}if(n.startsWith("/api/periods/")&&o==="PUT"){const s=p(n);return{data:O(s,c)}}if(n.startsWith("/api/periods/")&&o==="DELETE"){const s=p(n);return E(s),null}throw new D("Неподдерживаемый onboarding-запрос.",400,{path:n,method:o})},B=e=>(e??[]).reduce((t,a)=>t+(Number(a.amount)||0),0),F=e=>{const t=(e??[]).reduce((n,r)=>n+(Number(r.plannedAmount)||0),0),a=(e??[]).reduce((n,r)=>n+(Number(r.actualAmount)||0),0);return{totalPlanned:t,totalActual:a,totalDifference:t-a}},L=e=>Object.values(e).reduce((t,a)=>t+(a||0),0),C=(e,t,a)=>{if(!e||!t)return 0;const n=m(e),r=m(t);if(!Number.isFinite(n.getTime())||!Number.isFinite(r.getTime()))return 0;let o=0;const c=new Date(n);for(;c<=r;){const s=y(c);a[s]!==void 0&&(o+=1),c.setDate(c.getDate()+1)}return o},R=e=>{const{days:t,totalIncome:a,totalPlannedExpenses:n,totalDifference:r,totalUnforeseenAllocated:o,totalUnforeseenSpent:c,totalDailyExpenses:s,filledDays:i}=e,d=Math.max(0,c-o),l=a-n-o,u=t>0?l/t:0,h=l+r-s-d,g=Math.max(0,t-i),b=g>0?h/g:0,S=t>0&&i>=t;return{plannedPeriodSum:l,dailyAverage:u,actualRemaining:h,unforeseenOverrun:d,remainingDays:g,remainingDailyAverage:b,isDailyComplete:S}},G=e=>e.filter(t=>t.name.trim()===""&&t.amount!=="").map(t=>t.id),j=e=>{const t=["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],a=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0"),r=(e.getDay()+6)%7;return`${t[r]}, ${a}.${n}`},f=(e,t)=>{const a=new Date(e);return a.setDate(a.getDate()+t),a},q=(e,t)=>{const a=m(e),n=m(t),r=[];let o=new Date(a);for(;o<=n;){const c=[],i=(7-o.getDay())%7,d=Math.floor((n.getTime()-o.getTime())/(1e3*60*60*24)),l=f(o,Math.min(i,d));let u=new Date(o);for(;u<=l;)c.push(new Date(u)),u=f(u,1);r.push(c),o=f(l,1)}return r},J=(e,t)=>{const a=e.reduce((o,c)=>o+(t[y(c)]||0),0),n=e.filter(o=>t[y(o)]!==void 0).length,r=n>0?a/n:0;return{total:a,filledDays:n,average:r}};export{k as a,B as b,J as c,v as d,U as e,j as f,q as g,F as h,L as i,C as j,G as k,R as l,$ as o,W as t};
