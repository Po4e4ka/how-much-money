import{c as se,j as t,r as f,u as lt,H as it,L as Ve}from"./app-DiBp4JLJ.js";import{T as ot,a as dt,b as ct,A as mt}from"./app-layout-By0QSF5T.js";import{d as Pe}from"./index-BDqSilVs.js";import{P as Q,O as xt}from"./overlap-period-modal-CTOD496t.js";import{b as ut}from"./app-logo-icon-DcioA8SY.js";/* empty css            */import"./index-DE4KSncy.js";import"./index-BmpTmqID.js";const ft=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],pt=ut("CircleHelp",ft),ht=n=>{const e=se.c(14),{currentTitle:l,onConfirm:i,onCancel:a,confirmDisabled:s}=n,d=s===void 0?!1:s;let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=t.jsx("h3",{className:"font-display text-2xl",children:"Закрепить другой период?"}),e[0]=o):o=e[0];const m=l?`Сейчас закреплён период ${l}. Закрепить этот вместо него?`:"Сейчас уже есть закреплённый период. Закрепить этот вместо него?";let c;e[1]!==m?(c=t.jsx("p",{className:"mt-3 text-sm text-[#6a5d52] dark:text-white/70",children:m}),e[1]=m,e[2]=c):c=e[2];let h;e[3]!==a?(h=t.jsx(Q,{type:"button",onClick:a,className:"px-4 py-2",children:"Отмена"}),e[3]=a,e[4]=h):h=e[4];let w;e[5]!==d||e[6]!==i?(w=t.jsx(Q,{type:"button",onClick:i,tone:"success",className:"px-4 py-2",disabled:d,children:"Закрепить"}),e[5]=d,e[6]=i,e[7]=w):w=e[7];let x;e[8]!==h||e[9]!==w?(x=t.jsxs("div",{className:"mt-6 flex flex-wrap justify-end gap-3",children:[h,w]}),e[8]=h,e[9]=w,e[10]=x):x=e[10];let u;return e[11]!==c||e[12]!==x?(u=t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-6",children:t.jsxs("div",{className:"w-full max-w-xl rounded-lg border border-black/10 bg-white/95 p-6 text-[#1c1a17] shadow-[0_24px_60px_-28px_rgba(0,0,0,0.7)] dark:border-white/10 dark:bg-[#1c1a17] dark:text-white",children:[o,c,x]})}),e[11]=c,e[12]=x,e[13]=u):u=e[13],u},bt=n=>{const e=se.c(10),{onConfirm:l,onCancel:i,confirmDisabled:a}=n,s=a===void 0?!1:a;let d,o;e[0]===Symbol.for("react.memo_cache_sentinel")?(d=t.jsx("h3",{className:"font-display text-2xl",children:"Закрыть период?"}),o=t.jsx("p",{className:"mt-3 text-sm text-[#6a5d52] dark:text-white/70",children:"После закрытия период будет доступен только для просмотра. Редактировать данные больше нельзя."}),e[0]=d,e[1]=o):(d=e[0],o=e[1]);let m;e[2]!==i?(m=t.jsx(Q,{type:"button",onClick:i,className:"px-4 py-2",children:"Отмена"}),e[2]=i,e[3]=m):m=e[3];let c;e[4]!==s||e[5]!==l?(c=t.jsx(Q,{type:"button",onClick:l,tone:"success",className:"px-4 py-2",disabled:s,children:"Закрыть"}),e[4]=s,e[5]=l,e[6]=c):c=e[6];let h;return e[7]!==m||e[8]!==c?(h=t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-6",children:t.jsxs("div",{className:"w-full max-w-xl rounded-lg border border-black/10 bg-white/95 p-6 text-[#1c1a17] shadow-[0_24px_60px_-28px_rgba(0,0,0,0.7)] dark:border-white/10 dark:bg-[#1c1a17] dark:text-white",children:[d,o,t.jsxs("div",{className:"mt-6 flex flex-wrap justify-end gap-3",children:[m,c]})]})}),e[7]=m,e[8]=c,e[9]=h):h=e[9],h};function gt(n){const e=se.c(14),{text:l,ariaLabel:i}=n,[a,s]=f.useState(!1),[d,o]=f.useState(!1);let m,c;e[0]===Symbol.for("react.memo_cache_sentinel")?(m=()=>{if(typeof window>"u")return;const S=window.matchMedia("(hover: none) and (pointer: coarse)"),E=()=>s(S.matches);return E(),S.addEventListener("change",E),()=>S.removeEventListener("change",E)},c=[],e[0]=m,e[1]=c):(m=e[0],c=e[1]),f.useEffect(m,c);const h=a?d:void 0,w=i??"Подсказка";let x;e[2]!==a?(x=()=>{a&&o(wt)},e[2]=a,e[3]=x):x=e[3];let u;e[4]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsx(pt,{className:"h-4 w-4"}),e[4]=u):u=e[4];let v;e[5]!==w||e[6]!==x?(v=t.jsx(ot,{asChild:!0,children:t.jsx("button",{type:"button","aria-label":w,className:"inline-flex h-5 w-5 items-center justify-center rounded-full text-[#6a5d52] transition hover:text-[#1c1a17] dark:text-white/60 dark:hover:text-white",onClick:x,children:u})}),e[5]=w,e[6]=x,e[7]=v):v=e[7];let b;e[8]!==l?(b=t.jsx(dt,{className:"max-w-xs text-xs leading-relaxed",children:l}),e[8]=l,e[9]=b):b=e[9];let y;return e[10]!==h||e[11]!==v||e[12]!==b?(y=t.jsxs(ct,{open:h,onOpenChange:o,children:[v,b]}),e[10]=h,e[11]=v,e[12]=b,e[13]=y):y=e[13],y}function wt(n){return!n}const ne=n=>{const e=se.c(9),{children:l,className:i,tooltipText:a,tooltipAriaLabel:s}=n,d=`text-xs uppercase tracking-[0.3em] text-[#6a5d52] dark:text-white/60 ${i??""}`;let o;e[0]!==l?(o=t.jsx("span",{children:l}),e[0]=l,e[1]=o):o=e[1];let m;e[2]!==s||e[3]!==a?(m=a?t.jsx("span",{className:"ml-2 inline-flex align-middle",children:t.jsx(gt,{text:a,ariaLabel:s??"Дополнительная информация"})}):null,e[2]=s,e[3]=a,e[4]=m):m=e[4];let c;return e[5]!==d||e[6]!==o||e[7]!==m?(c=t.jsxs("div",{className:d,children:[o,m]}),e[5]=d,e[6]=o,e[7]=m,e[8]=c):c=e[8],c},Me=n=>{const e=se.c(3),{children:l,className:i}=n,a=`font-display text-2xl ${i??""}`;let s;return e[0]!==l||e[1]!==a?(s=t.jsx("div",{className:a,children:l}),e[0]=l,e[1]=a,e[2]=s):s=e[2],s},yt=n=>({"--delay":`${n}ms`}),jt={id:0,startDate:"",endDate:"",incomes:[],expenses:[],offIncomeExpenses:[],dailyExpenses:{},isPinned:!1,isClosed:!1},ee=n=>`${Math.max(0,Math.round(n)).toLocaleString("ru-RU")} ₽`,we=n=>{const e=Math.round(n);return e===0?"0 ₽":`${e>0?"+":"−"}${Math.abs(e).toLocaleString("ru-RU")} ₽`},re=n=>{const[e,l,i]=n.split("-").map(Number);return new Date(e,(l??1)-1,i??1)},be=n=>{const e=re(n),l=String(e.getDate()).padStart(2,"0"),i=String(e.getMonth()+1).padStart(2,"0");return`${l}.${i}`},kt=n=>new Intl.DateTimeFormat("ru-RU",{month:"long",year:"numeric"}).format(re(n)),ze=(n,e)=>{if(!n)return"";const[l,i,a]=n.split("-").map(Number);if(!l||!i||!a)return"";const s=i-1+e,d=l+Math.floor(s/12),o=(s%12+12)%12,m=new Date(d,o+1,0).getDate(),c=Math.min(a,m),h=String(o+1).padStart(2,"0"),w=String(c).padStart(2,"0");return`${d}-${h}-${w}`},Ye=(n,e)=>{const l=new Intl.DateTimeFormat("ru-RU",{month:"short"}),i=l.format(re(n)),a=l.format(re(e)),s=re(n).getFullYear(),d=re(e).getFullYear();return s===d?i===a?kt(n):`${i}–${a} ${s}`:`${i} ${s} – ${a} ${d}`},Ke=(n,e)=>{const l=re(n),a=re(e).getTime()-l.getTime(),s=Math.floor(a/(1e3*60*60*24));return Math.max(1,s+1)},Nt=n=>{const e=n.getFullYear(),l=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0");return`${e}-${l}-${i}`},ye=n=>{const e=n.replace(/\D/g,"");return e===""?"":Number(e)},De=n=>n===""?0:Number(n),qe=n=>n.filter(e=>e.name.trim()===""&&e.amount!=="").map(e=>e.id),Ue=n=>{const e=se.c(3),{children:l,className:i}=n,a=`flex flex-wrap items-center gap-2 text-xs font-semibold sm:text-sm ${i??""}`;let s;return e[0]!==l||e[1]!==a?(s=t.jsx("div",{className:a,children:l}),e[0]=l,e[1]=a,e[2]=s):s=e[2],s},fe=n=>{const e=se.c(3),{children:l,className:i}=n,a=`inline-flex items-center font-display tabular-nums leading-[0.9] ${i??""}`;let s;return e[0]!==l||e[1]!==a?(s=t.jsx("span",{className:a,children:l}),e[0]=l,e[1]=a,e[2]=s):s=e[2],s},Ce=n=>{const e=se.c(3),{children:l,className:i}=n,a=`inline-flex items-center leading-[0.9] relative -top-[1px] text-black/50 dark:text-white/60 ${i??""}`;let s;return e[0]!==l||e[1]!==a?(s=t.jsx("span",{className:a,children:l}),e[0]=l,e[1]=a,e[2]=s):s=e[2],s},vt=n=>{const e=se.c(51),{items:l,setItems:i,totalAmount:a,onAdd:s,showDelete:d,onToggleDelete:o,onBlurField:m,onAfterDelete:c,invalidNameIds:h,readOnly:w}=n,x=w===void 0?!1:w;let u;e[0]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsx(ne,{children:"Приход"}),e[0]=u):u=e[0];let v;e[1]!==s||e[2]!==x?(v=t.jsx(Q,{type:"button",onClick:s,disabled:x,children:"+ Строка"}),e[1]=s,e[2]=x,e[3]=v):v=e[3];let b;e[4]!==o||e[5]!==x||e[6]!==d?(b=t.jsx(Q,{type:"button",onClick:o,active:d,activeTone:"danger",disabled:x,children:"− Удаление"}),e[4]=o,e[5]=x,e[6]=d,e[7]=b):b=e[7];let y;e[8]!==v||e[9]!==b?(y=t.jsxs("div",{className:"flex items-center justify-between",children:[u,t.jsxs("div",{className:"flex items-center gap-2",children:[v,b]})]}),e[8]=v,e[9]=b,e[10]=y):y=e[10];const S=`mt-3 hidden items-center gap-2 text-[11px] uppercase tracking-[0.2em] text-[#6a5d52] dark:text-white/60 sm:grid ${d?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)]"}`;let E,L;e[11]===Symbol.for("react.memo_cache_sentinel")?(E=t.jsx("span",{children:"Название"}),L=t.jsx("span",{className:"text-right",children:"Сумма"}),e[11]=E,e[12]=L):(E=e[11],L=e[12]);let O;e[13]!==d?(O=d&&t.jsx("span",{className:"text-center",children:"—"}),e[13]=d,e[14]=O):O=e[14];let R;e[15]!==S||e[16]!==O?(R=t.jsxs("div",{className:S,children:[E,L,O]}),e[15]=S,e[16]=O,e[17]=R):R=e[17];let q;if(e[18]!==h||e[19]!==l||e[20]!==c||e[21]!==m||e[22]!==x||e[23]!==i||e[24]!==d){let X;e[26]!==h||e[27]!==c||e[28]!==m||e[29]!==x||e[30]!==i||e[31]!==d?(X=(k,J)=>t.jsxs("div",{className:`grid items-center gap-2 ${d?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)]"}`,children:[t.jsx("input",{type:"text",placeholder:`Приход ${J+1}`,value:k.name,disabled:x,onChange:_=>i(g=>g.map(H=>H.id===k.id?{...H,name:_.target.value}:H)),onBlur:m,className:`rounded-lg border bg-white/90 px-3 py-2 text-xs dark:bg-white/10 sm:px-4 sm:text-sm ${h.includes(k.id)?"border-[#b0352b] dark:border-[#ff8b7c]":"border-black/10 dark:border-white/10"}`}),t.jsx("input",{type:"number",min:0,step:1,inputMode:"numeric",value:k.amount,disabled:x,onChange:_=>{const g=_.target.value;i(H=>H.map(B=>B.id===k.id?{...B,amount:ye(g)}:B))},onFocus:()=>{k.amount===0&&i(_=>_.map(g=>g.id===k.id?{...g,amount:""}:g))},onBlur:()=>{k.amount===""&&i(_=>_.map(g=>g.id===k.id?{...g,amount:0}:g)),m()},className:"no-spin rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs text-right tabular-nums dark:border-white/10 dark:bg-white/10 sm:px-4 sm:text-sm"}),d&&t.jsx("button",{type:"button",onClick:()=>{window.confirm("Удалить строку?")&&(i(_=>_.filter(g=>g.id!==k.id)),c())},"aria-label":`Удалить приход ${J+1}`,className:"flex h-8 w-8 items-center justify-center rounded-full text-xs text-[#b0352b] transition hover:bg-[#b0352b]/10 dark:text-[#ff8b7c] dark:hover:bg-[#ff8b7c]/15",disabled:x,children:"—"})]},k.id),e[26]=h,e[27]=c,e[28]=m,e[29]=x,e[30]=i,e[31]=d,e[32]=X):X=e[32],q=l.map(X),e[18]=h,e[19]=l,e[20]=c,e[21]=m,e[22]=x,e[23]=i,e[24]=d,e[25]=q}else q=e[25];let P;e[33]!==q?(P=t.jsx("div",{className:"mt-3 grid gap-2",children:q}),e[33]=q,e[34]=P):P=e[34];const U=`mt-3 grid items-center gap-2 rounded-lg border border-dashed border-black/10 bg-white/70 px-4 py-2 text-xs dark:border-white/10 dark:bg-white/5 ${d?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)]"}`;let $;e[35]===Symbol.for("react.memo_cache_sentinel")?($=t.jsx("span",{children:"Итого прихода"}),e[35]=$):$=e[35];let F;e[36]!==a?(F=ee(a),e[36]=a,e[37]=F):F=e[37];let z;e[38]!==F?(z=t.jsx("span",{className:"text-right font-display text-sm tabular-nums",children:F}),e[38]=F,e[39]=z):z=e[39];let T;e[40]!==d?(T=d&&t.jsx("span",{}),e[40]=d,e[41]=T):T=e[41];let A;e[42]!==U||e[43]!==z||e[44]!==T?(A=t.jsxs("div",{className:U,children:[$,z,T]}),e[42]=U,e[43]=z,e[44]=T,e[45]=A):A=e[45];let j;return e[46]!==R||e[47]!==P||e[48]!==A||e[49]!==y?(j=t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/80 px-5 py-4 text-sm shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-white/10",children:[y,R,P,A]}),e[46]=R,e[47]=P,e[48]=A,e[49]=y,e[50]=j):j=e[50],j},_t=n=>{const e=se.c(71),{title:l,items:i,setItems:a,showDelete:s,onToggleDelete:d,totalLabel:o,totalPlanned:m,totalActual:c,totalDifference:h,idPrefix:w,onBlurField:x,onAfterDelete:u,readOnly:v}=n,b=v===void 0?!1:v;let y;e[0]!==l?(y=t.jsx(ne,{children:l}),e[0]=l,e[1]=y):y=e[1];let S;e[2]!==w||e[3]!==a?(S=()=>a(ce=>[...ce,{id:`${w}${Date.now()}`,name:"",plannedAmount:"",actualAmount:"",actualTouched:!1}]),e[2]=w,e[3]=a,e[4]=S):S=e[4];let E;e[5]!==b||e[6]!==S?(E=t.jsx(Q,{type:"button",onClick:S,disabled:b,children:"+ Строка"}),e[5]=b,e[6]=S,e[7]=E):E=e[7];let L;e[8]!==d||e[9]!==b||e[10]!==s?(L=t.jsx(Q,{type:"button",onClick:d,active:s,activeTone:"danger",disabled:b,children:"− Удаление"}),e[8]=d,e[9]=b,e[10]=s,e[11]=L):L=e[11];let O;e[12]!==E||e[13]!==L?(O=t.jsxs("div",{className:"flex items-center gap-2",children:[E,L]}),e[12]=E,e[13]=L,e[14]=O):O=e[14];let R;e[15]!==y||e[16]!==O?(R=t.jsxs("div",{className:"flex items-center justify-between",children:[y,O]}),e[15]=y,e[16]=O,e[17]=R):R=e[17];const q=`mt-3 grid items-center gap-2 text-[11px] uppercase tracking-[0.2em] text-[#6a5d52] dark:text-white/60 ${s?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_minmax(0,0.7fr)]"}`;let P,U,$;e[18]===Symbol.for("react.memo_cache_sentinel")?($=t.jsxs("span",{children:[t.jsx("span",{className:"sm:hidden",children:"Название"}),t.jsx("span",{className:"hidden sm:inline",children:"Название"})]}),P=t.jsx("span",{className:"text-right",children:"План"}),U=t.jsx("span",{className:"text-right",children:"Факт"}),e[18]=P,e[19]=U,e[20]=$):(P=e[18],U=e[19],$=e[20]);let F;e[21]===Symbol.for("react.memo_cache_sentinel")?(F=t.jsxs("span",{className:"text-right",children:[t.jsx("span",{className:"sm:hidden",children:"Разн"}),t.jsx("span",{className:"hidden sm:inline",children:"Разница"})]}),e[21]=F):F=e[21];let z;e[22]!==s?(z=s&&t.jsx("span",{className:"text-center",children:"—"}),e[22]=s,e[23]=z):z=e[23];let T;e[24]!==z||e[25]!==q?(T=t.jsxs("div",{className:q,children:[$,P,U,F,z]}),e[24]=z,e[25]=q,e[26]=T):T=e[26];let A;if(e[27]!==i||e[28]!==u||e[29]!==x||e[30]!==b||e[31]!==a||e[32]!==s){let ce;e[34]!==u||e[35]!==x||e[36]!==b||e[37]!==a||e[38]!==s?(ce=(D,je)=>t.jsxs("div",{className:`grid items-center gap-2 ${s?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_minmax(0,0.7fr)]"}`,children:[t.jsx("input",{type:"text",placeholder:`Трата ${je+1}`,value:D.name,disabled:b,onChange:Y=>a(N=>N.map(ae=>ae.id===D.id?{...ae,name:Y.target.value}:ae)),onBlur:x,className:"rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs dark:border-white/10 dark:bg-white/10 sm:px-4 sm:text-sm"}),t.jsx("input",{type:"number",min:0,step:1,inputMode:"numeric",value:D.plannedAmount,disabled:b,onChange:Y=>{const N=Y.target.value;a(ae=>ae.map(te=>te.id===D.id?{...te,plannedAmount:ye(N),actualAmount:te.actualTouched?te.actualAmount:ye(N)}:te))},onFocus:()=>{D.plannedAmount===0&&a(Y=>Y.map(N=>N.id===D.id?{...N,plannedAmount:""}:N))},onBlur:()=>{D.plannedAmount===""&&a(Y=>Y.map(N=>N.id===D.id?{...N,plannedAmount:0}:N)),x()},className:"no-spin rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs text-right tabular-nums dark:border-white/10 dark:bg-white/10 sm:px-4 sm:text-sm"}),t.jsx("input",{type:"number",min:0,step:1,inputMode:"numeric",value:D.actualAmount,disabled:b,onChange:Y=>{const N=Y.target.value;a(ae=>ae.map(te=>te.id===D.id?{...te,actualAmount:ye(N),actualTouched:!0}:te))},onFocus:()=>{D.actualAmount===0&&a(Y=>Y.map(N=>N.id===D.id?{...N,actualAmount:""}:N))},onBlur:()=>{D.actualAmount===""&&a(Y=>Y.map(N=>N.id===D.id?{...N,actualAmount:0}:N)),x()},className:"no-spin rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs text-right tabular-nums dark:border-white/10 dark:bg-white/10 sm:px-4 sm:text-sm"}),t.jsx("div",{className:`flex min-h-[36px] items-center justify-end px-0 py-2 text-xs tabular-nums sm:min-h-[40px] sm:px-4 sm:text-sm ${D.plannedAmount-D.actualAmount>0?"text-[#1e7b4f] dark:text-[#7ce0b3]":D.plannedAmount-D.actualAmount<0?"text-[#b0352b] dark:text-[#ff8b7c]":"text-[#6a5d52] dark:text-white/70"}`,children:we(D.plannedAmount-D.actualAmount)}),s&&t.jsx("button",{type:"button",onClick:()=>{window.confirm("Удалить строку?")&&(a(Y=>Y.filter(N=>N.id!==D.id)),u())},"aria-label":`Удалить трату ${je+1}`,className:"flex h-8 w-8 items-center justify-center rounded-full text-xs text-[#b0352b] transition hover:bg-[#b0352b]/10 dark:text-[#ff8b7c] dark:hover:bg-[#ff8b7c]/15",disabled:b,children:"—"})]},D.id),e[34]=u,e[35]=x,e[36]=b,e[37]=a,e[38]=s,e[39]=ce):ce=e[39],A=i.map(ce),e[27]=i,e[28]=u,e[29]=x,e[30]=b,e[31]=a,e[32]=s,e[33]=A}else A=e[33];let j;e[40]!==A?(j=t.jsx("div",{className:"mt-3 grid gap-2",children:A}),e[40]=A,e[41]=j):j=e[41];const X=`mt-3 grid items-center gap-2 rounded-lg border border-dashed border-black/10 bg-white/70 px-4 py-2 text-xs dark:border-white/10 dark:bg-white/5 ${s?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_minmax(0,0.7fr)]"}`;let k;e[42]!==o?(k=t.jsx("span",{children:o}),e[42]=o,e[43]=k):k=e[43];let J;e[44]!==m?(J=ee(m),e[44]=m,e[45]=J):J=e[45];let _;e[46]!==J?(_=t.jsx("span",{className:"text-right font-display text-sm tabular-nums",children:J}),e[46]=J,e[47]=_):_=e[47];let g;e[48]!==c?(g=ee(c),e[48]=c,e[49]=g):g=e[49];let H;e[50]!==g?(H=t.jsx("span",{className:"text-right font-display text-sm tabular-nums",children:g}),e[50]=g,e[51]=H):H=e[51];const B=`text-right font-display text-sm tabular-nums ${h>0?"text-[#1e7b4f] dark:text-[#7ce0b3]":h<0?"text-[#b0352b] dark:text-[#ff8b7c]":"text-[#6a5d52] dark:text-white/70"}`;let M;e[52]!==h?(M=we(h),e[52]=h,e[53]=M):M=e[53];let Z;e[54]!==B||e[55]!==M?(Z=t.jsx("span",{className:B,children:M}),e[54]=B,e[55]=M,e[56]=Z):Z=e[56];let W;e[57]!==s?(W=s&&t.jsx("span",{}),e[57]=s,e[58]=W):W=e[58];let de;e[59]!==X||e[60]!==k||e[61]!==_||e[62]!==H||e[63]!==Z||e[64]!==W?(de=t.jsxs("div",{className:X,children:[k,_,H,Z,W]}),e[59]=X,e[60]=k,e[61]=_,e[62]=H,e[63]=Z,e[64]=W,e[65]=de):de=e[65];let le;return e[66]!==T||e[67]!==j||e[68]!==de||e[69]!==R?(le=t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/80 px-5 py-4 text-sm shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-white/10",children:[R,T,j,de]}),e[66]=T,e[67]=j,e[68]=de,e[69]=R,e[70]=le):le=e[70],le},Dt=n=>{const e=se.c(58),{title:l,items:i,setItems:a,showDelete:s,onToggleDelete:d,totalLabel:o,totalAmount:m,idPrefix:c,onBlurField:h,onAfterDelete:w,readOnly:x}=n,u=x===void 0?!1:x;let v;e[0]!==l?(v=t.jsx(ne,{tooltipText:"Эти траты не учитываются в расчётах.",tooltipAriaLabel:"Сторонние траты",children:l}),e[0]=l,e[1]=v):v=e[1];let b;e[2]!==c||e[3]!==a?(b=()=>a(_=>[..._,{id:`${c}${Date.now()}`,name:"",amount:""}]),e[2]=c,e[3]=a,e[4]=b):b=e[4];let y;e[5]!==u||e[6]!==b?(y=t.jsx(Q,{type:"button",onClick:b,disabled:u,children:"+ Строка"}),e[5]=u,e[6]=b,e[7]=y):y=e[7];let S;e[8]!==d||e[9]!==u||e[10]!==s?(S=t.jsx(Q,{type:"button",onClick:d,active:s,activeTone:"danger",disabled:u,children:"− Удаление"}),e[8]=d,e[9]=u,e[10]=s,e[11]=S):S=e[11];let E;e[12]!==y||e[13]!==S?(E=t.jsxs("div",{className:"flex items-center gap-2",children:[y,S]}),e[12]=y,e[13]=S,e[14]=E):E=e[14];let L;e[15]!==v||e[16]!==E?(L=t.jsxs("div",{className:"flex items-center justify-between",children:[v,E]}),e[15]=v,e[16]=E,e[17]=L):L=e[17];const O=`mt-3 hidden items-center gap-2 text-[11px] uppercase tracking-[0.2em] text-[#6a5d52] dark:text-white/60 sm:grid ${s?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)]"}`;let R,q;e[18]===Symbol.for("react.memo_cache_sentinel")?(q=t.jsx("span",{children:"Название"}),R=t.jsx("span",{className:"text-right",children:"Сумма"}),e[18]=R,e[19]=q):(R=e[18],q=e[19]);let P;e[20]!==s?(P=s&&t.jsx("span",{className:"text-center",children:"—"}),e[20]=s,e[21]=P):P=e[21];let U;e[22]!==P||e[23]!==O?(U=t.jsxs("div",{className:O,children:[q,R,P]}),e[22]=P,e[23]=O,e[24]=U):U=e[24];let $;if(e[25]!==i||e[26]!==w||e[27]!==h||e[28]!==u||e[29]!==a||e[30]!==s){let _;e[32]!==w||e[33]!==h||e[34]!==u||e[35]!==a||e[36]!==s?(_=(g,H)=>t.jsxs("div",{className:`grid items-center gap-2 ${s?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)]"}`,children:[t.jsx("input",{type:"text",placeholder:`Трата ${H+1}`,value:g.name,disabled:u,onChange:B=>a(M=>M.map(Z=>Z.id===g.id?{...Z,name:B.target.value}:Z)),onBlur:h,className:"rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs dark:border-white/10 dark:bg-white/10 sm:px-4 sm:text-sm"}),t.jsx("input",{type:"number",min:0,step:1,inputMode:"numeric",value:g.amount,disabled:u,onChange:B=>{const M=B.target.value;a(Z=>Z.map(W=>W.id===g.id?{...W,amount:ye(M)}:W))},onFocus:()=>{g.amount===0&&a(B=>B.map(M=>M.id===g.id?{...M,amount:""}:M))},onBlur:()=>{g.amount===""&&a(B=>B.map(M=>M.id===g.id?{...M,amount:0}:M)),h()},className:"no-spin rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs text-right tabular-nums text-[#b0352b] dark:border-white/10 dark:bg-white/10 dark:text-[#ff8b7c] sm:px-4 sm:text-sm"}),s&&t.jsx("button",{type:"button",onClick:()=>{window.confirm("Удалить строку?")&&(a(B=>B.filter(M=>M.id!==g.id)),w())},"aria-label":`Удалить трату ${H+1}`,className:"flex h-8 w-8 items-center justify-center rounded-full text-xs text-[#b0352b] transition hover:bg-[#b0352b]/10 dark:text-[#ff8b7c] dark:hover:bg-[#ff8b7c]/15",disabled:u,children:"—"})]},g.id),e[32]=w,e[33]=h,e[34]=u,e[35]=a,e[36]=s,e[37]=_):_=e[37],$=i.map(_),e[25]=i,e[26]=w,e[27]=h,e[28]=u,e[29]=a,e[30]=s,e[31]=$}else $=e[31];let F;e[38]!==$?(F=t.jsx("div",{className:"mt-3 grid gap-2",children:$}),e[38]=$,e[39]=F):F=e[39];const z=`mt-3 grid items-center gap-2 rounded-lg border border-dashed border-black/10 bg-white/70 px-4 py-2 text-xs dark:border-white/10 dark:bg-white/5 ${s?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)]"}`;let T;e[40]!==o?(T=t.jsx("span",{children:o}),e[40]=o,e[41]=T):T=e[41];let A;e[42]!==m?(A=ee(m),e[42]=m,e[43]=A):A=e[43];let j;e[44]!==A?(j=t.jsx("span",{className:"text-right font-display text-sm tabular-nums text-[#b0352b] dark:text-[#ff8b7c]",children:A}),e[44]=A,e[45]=j):j=e[45];let X;e[46]!==s?(X=s&&t.jsx("span",{}),e[46]=s,e[47]=X):X=e[47];let k;e[48]!==z||e[49]!==T||e[50]!==j||e[51]!==X?(k=t.jsxs("div",{className:z,children:[T,j,X]}),e[48]=z,e[49]=T,e[50]=j,e[51]=X,e[52]=k):k=e[52];let J;return e[53]!==U||e[54]!==F||e[55]!==k||e[56]!==L?(J=t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/80 px-5 py-4 text-sm shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-white/10",children:[L,U,F,k]}),e[53]=U,e[54]=F,e[55]=k,e[56]=L,e[57]=J):J=e[57],J};function Mt(){const{periodId:n}=lt().props,[e,l]=f.useState(jt),[i,a]=f.useState([]),[s,d]=f.useState(""),[o,m]=f.useState(""),[c,h]=f.useState([]),[w,x]=f.useState([]),[u,v]=f.useState({}),[b,y]=f.useState(!1),[S,E]=f.useState(!1),[L,O]=f.useState(!0),[R,q]=f.useState(null),[P,U]=f.useState(!1),[$,F]=f.useState(null),[z,T]=f.useState(!1),[A,j]=f.useState(null),[X,k]=f.useState(!1),[J,_]=f.useState([]),[g,H]=f.useState(!1),[B,M]=f.useState(!1),[Z,W]=f.useState(!1),[de,le]=f.useState(!1),[ce,D]=f.useState(!1),[je,Y]=f.useState(),N=f.useRef(!1),[ae,te]=f.useState(0),Fe="Заполните названия прихода.",pe=f.useRef(null),ke=f.useRef(null),Oe=f.useMemo(()=>`period:${n}`,[n]),Se=f.useRef(!1),$e=f.useRef(!1),He=()=>typeof window>"u"?null:window.__periodCache?.[Oe]??null,Ne=r=>{if(typeof window>"u")return;const p=window;p.__periodCache||(p.__periodCache={}),p.__periodCache[Oe]=r},ve=(c??[]).reduce((r,p)=>r+(Number(p.plannedAmount)||0),0),Re=(c??[]).reduce((r,p)=>r+(Number(p.actualAmount)||0),0),xe=ve-Re,Xe=(w??[]).reduce((r,p)=>r+(Number(p.amount)||0),0),Ae=(i??[]).reduce((r,p)=>r+(Number(p.amount)||0),0),me=f.useMemo(()=>!s||!o?0:Ke(s,o),[s,o]),ge=f.useMemo(()=>Object.values(u).reduce((r,p)=>r+(p||0),0),[u]),_e=f.useMemo(()=>{if(!s||!o)return 0;const r=re(s),p=re(o);if(!Number.isFinite(r.getTime())||!Number.isFinite(p.getTime()))return 0;let G=0;const I=new Date(r);for(;I<=p;){const K=Nt(I);u[K]!==void 0&&(G+=1),I.setDate(I.getDate()+1)}return G},[u,s,o]),Je=_e>0?ge/_e:0,Ee=f.useMemo(()=>!s||!o?"Период":`${be(s)} — ${be(o)}`,[s,o]),Ze=f.useMemo(()=>!s||!o?"":`${me} дней · ${Ye(s,o)}`,[me,s,o]),ue=Ae-ve,Ge=me>0?ue/me:0,Be=ue+xe-ge,Te=Math.max(0,me-_e),Qe=Te>0?Be/Te:0,We=me>0&&_e>=me,he=e.isClosed,et=[{title:"Dashboard",href:Pe().url},{title:Ee,href:`/periods/${n}`}],tt=r=>!!(r&&r.id&&Array.isArray(r.incomes)&&Array.isArray(r.expenses)&&Array.isArray(r.offIncomeExpenses)),st=async()=>{if($e.current)return;const r=He();if(!(tt(r)&&(l({...r,isClosed:!!r.isClosed}),a(r.incomes??[]),d(r.startDate??""),m(r.endDate??""),h(r.expenses??[]),x(r.offIncomeExpenses??[]),v(r.dailyExpenses??{}),pe.current={startDate:r.startDate??"",endDate:r.endDate??""},O(!1),typeof navigator<"u"&&!navigator.onLine))&&!(Se.current&&(!navigator.onLine||!r))){$e.current=!0,O(!0),q(null);try{const p=await fetch(`/api/periods/${n}`);if(!p.ok)throw new Error("Не удалось загрузить период.");const I=(await p.json()).data,K={id:I.id,startDate:I.start_date,endDate:I.end_date,dailyExpenses:I.daily_expenses??{},isPinned:!!I.is_pinned,isClosed:!!I.is_closed,incomes:I.incomes.map(V=>({id:String(V.id),name:V.name,amount:V.amount})),expenses:I.expenses.map(V=>({id:String(V.id),name:V.name,plannedAmount:V.planned_amount,actualAmount:V.actual_amount,actualTouched:!1})),offIncomeExpenses:I.external_expenses.map(V=>({id:String(V.id),name:V.name,amount:V.amount}))};l(K),a(K.incomes),d(K.startDate),m(K.endDate),h(K.expenses),x(K.offIncomeExpenses),v(K.dailyExpenses),le(!1),Y(void 0),pe.current={startDate:K.startDate,endDate:K.endDate},Ne(K),Se.current=!0}catch(p){q(p instanceof Error?p.message:"Не удалось загрузить период.")}finally{O(!1),$e.current=!1}}},ie=async(r=!1,p)=>{if(e.isClosed)return;const G=p?.startDate??s,I=p?.endDate??o,K=qe(i);if(K.length>0){_(K),j(Fe);return}if(P){N.current=!0;return}U(!0),j(null),k(!1);try{const V=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")??"",oe=await fetch(`/api/periods/${n}`,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":V},body:JSON.stringify({start_date:G,end_date:I,daily_expenses:u,force:r,incomes:i.filter(C=>C.name.trim()!=="").map(C=>({id:Number.isFinite(Number(C.id))?Number(C.id):void 0,name:C.name,amount:De(C.amount)})),expenses:c.filter(C=>C.name.trim()!=="").map(C=>({id:Number.isFinite(Number(C.id))?Number(C.id):void 0,name:C.name,planned_amount:De(C.plannedAmount),actual_amount:De(C.actualAmount)})),external_expenses:w.filter(C=>C.name.trim()!=="").map(C=>({id:Number.isFinite(Number(C.id))?Number(C.id):void 0,name:C.name,amount:De(C.amount)}))})});if(oe.status===409){const C=await oe.json();if(C.overlap){ke.current={startDate:G,endDate:I},F(C.overlap),T(!0),pe.current&&(d(pe.current.startDate),m(pe.current.endDate));return}throw new Error("Период пересекается с существующим.")}if(!oe.ok){if(oe.status===423){const C=await oe.json();throw new Error(C.message??"Период закрыт и не редактируется.")}throw new Error("Не удалось сохранить период.")}d(G),m(I),k(!0),F(null),T(!1),ke.current=null,pe.current={startDate:G,endDate:I},Ne({id:Number(n),startDate:G,endDate:I,incomes:i,expenses:c,offIncomeExpenses:w,dailyExpenses:u,isPinned:e.isPinned,isClosed:e.isClosed})}catch(V){j(V instanceof Error?V.message:"Не удалось сохранить период.")}finally{U(!1)}},at=()=>{e.isClosed||(a(r=>[...r,{id:`i${Date.now()}`,name:"",amount:""}]),ie())},Ie=()=>{te(r=>r+1)},nt=async()=>{if(!g&&window.confirm("Удалить период?")){H(!0),j(null);try{const r=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")??"";if(!(await fetch(`/api/periods/${n}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":r}})).ok)throw new Error("Не удалось удалить период.");window.location.href=Pe().url}catch(r){j(r instanceof Error?r.message:"Не удалось удалить период.")}finally{H(!1)}}},rt=async()=>{if(!(Z||e.isClosed)){W(!0),j(null);try{const r=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")??"",p=await fetch(`/api/periods/${n}/close`,{method:"POST",headers:{"X-CSRF-TOKEN":r}});if(!p.ok){const K=await p.json();throw new Error(K.message??"Не удалось закрыть период.")}const G=await p.json(),I={...e,isClosed:G.data?.is_closed??!0};l(I),D(!1),Ne({id:Number(n),startDate:s,endDate:o,incomes:i,expenses:c,offIncomeExpenses:w,dailyExpenses:u,isPinned:e.isPinned,isClosed:I.isClosed})}catch(r){j(r instanceof Error?r.message:"Не удалось закрыть период.")}finally{W(!1)}}},Le=async(r=!1)=>{if(!B){M(!0);try{const p=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")??"",G=await fetch(`/api/periods/${n}/pin`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":p},body:JSON.stringify({pinned:!e.isPinned,force:r})});if(G.status===409){const oe=await G.json();oe.pinned?Y(`${be(oe.pinned.start_date)} — ${be(oe.pinned.end_date)}`):Y(void 0),le(!0);return}if(!G.ok)throw new Error("Не удалось изменить закрепление периода.");const K=(await G.json()).data?.is_pinned??!e.isPinned,V={...e,isPinned:K};l(V),Ne(V),le(!1)}catch(p){j(p instanceof Error?p.message:"Не удалось изменить закрепление периода.")}finally{M(!1)}}};return f.useEffect(()=>{Se.current=!1,st()},[n]),f.useEffect(()=>{!P&&N.current&&(N.current=!1,ie())},[P]),f.useEffect(()=>{ae>0&&ie()},[ae]),f.useEffect(()=>{const r=qe(i);_(r),r.length===0&&A===Fe&&j(null)},[i,A]),t.jsxs(mt,{breadcrumbs:et,children:[t.jsx(it,{title:Ee}),t.jsxs("div",{className:`relative flex flex-1 flex-col gap-8 overflow-x-hidden rounded-xl p-3 font-body text-[#1c1a17] dark:text-[#f7f3ee]${e.isClosed?" bg-emerald-50/70 dark:bg-emerald-950/20":""}`,children:[t.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-3xl bg-aurora opacity-35 dark:hidden"}),t.jsx("div",{className:"pointer-events-none absolute inset-0 hidden rounded-3xl bg-aurora-night opacity-45 dark:block"}),t.jsxs("section",{className:"relative z-10 flex flex-wrap items-center justify-between gap-6",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-[#6a5d52] dark:text-white/60",children:"Период"}),t.jsx("h1",{className:"mt-3 font-display text-3xl",children:Ee}),t.jsx("p",{className:"mt-2 text-sm text-[#6a5d52] dark:text-white/70",children:Ze})]}),e.isClosed&&t.jsx("div",{className:"flex-1 text-center text-sm font-semibold text-emerald-600 dark:text-emerald-300",children:"Период закрыт"}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[!e.isClosed&&t.jsx(Q,{type:"button",onClick:()=>Le(!1),tone:e.isPinned?"danger":"success",disabled:B,className:"px-4 py-2",children:e.isPinned?"Открепить":"Закрепить"}),We&&!e.isClosed&&t.jsx(Q,{type:"button",onClick:()=>D(!0),disabled:Z,tone:"success",className:"px-4 py-2",children:"Закрыть период"}),t.jsx(Q,{type:"button",onClick:nt,disabled:g,tone:"danger",className:"px-4 py-2",children:"Удалить"}),t.jsx(Ve,{href:Pe(),prefetch:!0,className:"rounded-full border border-black/10 bg-white/80 px-4 py-2 text-xs text-[#1c1a17] shadow-[0_16px_32px_-24px_rgba(28,26,23,0.6)] transition hover:-translate-y-0.5 dark:border-white/10 dark:bg-white/10 dark:text-white",children:"← Ко всем периодам"})]})]}),t.jsxs("section",{className:"relative z-10 grid gap-6 lg:grid-cols-[1.1fr_0.9fr] lg:items-start animate-reveal",style:yt(120),children:[L&&t.jsx("div",{className:"col-span-full rounded-lg border border-black/10 bg-white/70 px-5 py-4 text-sm text-[#6a5d52] dark:border-white/10 dark:bg-white/10 dark:text-white/70",children:"Загружаем период..."}),R&&t.jsx("div",{className:"col-span-full rounded-lg border border-black/10 bg-white/70 px-5 py-4 text-sm text-[#b0352b] dark:border-white/10 dark:bg-white/10 dark:text-[#ff8b7c]",children:R}),t.jsxs("div",{className:"order-2 grid gap-4 lg:order-none lg:self-start",children:[t.jsx(vt,{items:i,setItems:a,totalAmount:Ae,onAdd:at,showDelete:b,onToggleDelete:()=>y(r=>!r),onBlurField:ie,onAfterDelete:Ie,invalidNameIds:J,readOnly:he}),t.jsx(_t,{title:"Обязательные траты",items:c,setItems:h,showDelete:b,onToggleDelete:()=>y(r=>!r),totalLabel:"Итого обязательных",totalPlanned:ve,totalActual:Re,totalDifference:xe,idPrefix:"e",onBlurField:ie,onAfterDelete:Ie,readOnly:he}),t.jsx(Dt,{title:"Сторонние траты",items:w,setItems:x,showDelete:b,onToggleDelete:()=>y(r=>!r),totalLabel:"Итого сторонних",totalAmount:Xe,idPrefix:"o",onBlurField:ie,onAfterDelete:Ie,readOnly:he})]}),t.jsxs("div",{className:"order-1 grid gap-4 lg:order-none lg:self-start",children:[t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/80 px-5 py-4 text-sm shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-white/10",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(ne,{children:"Дни периода"}),t.jsx(Q,{type:"button",onClick:()=>E(r=>!r),active:S,activeTone:"success",disabled:he,children:S?"Готово":"Редактировать"})]}),t.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[t.jsx("div",{className:"px-1 text-base font-semibold tabular-nums",children:me}),t.jsx("span",{className:"text-xs text-[#6a5d52] dark:text-white/60",children:"дней"})]}),S&&t.jsxs("div",{className:"mt-3 grid gap-2 grid-cols-2",children:[t.jsxs("label",{className:"grid gap-1 text-xs text-[#6a5d52] dark:text-white/60",children:["Начало",t.jsx("input",{type:"date",value:s,disabled:he,onChange:r=>{const p=r.target.value;d(p),ie(!1,{startDate:p})},min:o?ze(o,-3):void 0,max:o,className:"rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs dark:border-white/10 dark:bg-white/10 sm:text-sm"})]}),t.jsxs("label",{className:"grid gap-1 text-xs text-[#6a5d52] dark:text-white/60",children:["Конец",t.jsx("input",{type:"date",value:o,disabled:he,onChange:r=>{const p=r.target.value;m(p),ie(!1,{endDate:p})},min:s,max:s?ze(s,3):void 0,className:"rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs dark:border-white/10 dark:bg-white/10 sm:text-sm"})]})]})]}),t.jsx(Ve,{href:`/periods/${n}/daily`,prefetch:!0,className:"group rounded-lg border border-[#1e7b4f]/30 bg-white/90 px-5 py-4 text-sm text-[#1c1a17] shadow-[0_24px_48px_-28px_rgba(30,123,79,0.55)] transition hover:-translate-y-0.5 hover:shadow-[0_28px_60px_-30px_rgba(30,123,79,0.65)] dark:border-[#7ce0b3]/30 dark:bg-white/10 dark:text-white",children:t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsx(ne,{children:"Ежедневные траты"}),t.jsx(Q,{as:"span",children:"Перейти к дневным значениям"})]})}),t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/85 px-5 py-6 text-[#1c1a17] shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-[#1c1a17] dark:text-white dark:shadow-[0_20px_40px_-26px_rgba(0,0,0,0.7)]",children:[t.jsx(ne,{children:"Планируемое среднее в день"}),t.jsx("p",{className:"mt-2 text-xs text-[#6a5d52] dark:text-white/60",children:"(Приход − обязательные) / дни"}),t.jsx(Me,{className:"mt-3",children:ee(Ge)}),t.jsxs("div",{className:"mt-4 grid gap-3 text-xs text-[#6a5d52] dark:text-white/70",children:[t.jsx("div",{className:"h-px w-full bg-black/10 dark:bg-white/10"}),t.jsx(ne,{children:"Планируемая сумма на период"}),t.jsxs(Ue,{children:[t.jsx(fe,{className:"text-[#1e7b4f] dark:text-[#7ce0b3]",children:ee(Ae)}),t.jsx(Ce,{children:"−"}),t.jsx(fe,{className:"text-[#b0352b] dark:text-[#ff8b7c]",children:ee(ve)}),t.jsx(Ce,{children:"="}),t.jsx(fe,{className:`${ue>=0?"text-[#1e7b4f] dark:text-[#7ce0b3]":"text-[#b0352b] dark:text-[#ff8b7c]"}`,children:we(ue)})]}),t.jsx("div",{className:"text-[11px] uppercase tracking-[0.2em] text-[#6a5d52] dark:text-white/60",children:"Приход − план = сумма в период"})]})]}),t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/85 px-5 py-6 text-[#1c1a17] shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-[#1c1a17] dark:text-white dark:shadow-[0_20px_40px_-26px_rgba(0,0,0,0.7)]",children:[t.jsx(ne,{tooltipText:"Фактический остаток / количество незаполненных (непрошедших) дней",children:"Расчётное в день на оставшиеся дни"}),t.jsxs("p",{className:"mt-2 text-xs text-[#6a5d52] dark:text-white/60",children:["(",ee(Be)," / ",Te||0," д.)"]}),t.jsx(Me,{className:"mt-3",children:ee(Qe)})]}),t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/85 px-5 py-6 text-[#1c1a17] shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-[#1c1a17] dark:text-white dark:shadow-[0_20px_40px_-26px_rgba(0,0,0,0.7)]",children:[t.jsx(ne,{tooltipText:"Планируемый остаток +/− фактическая разница − ежедневные траты за период.",tooltipAriaLabel:"Формула фактического остатка",children:"Фактический остаток"}),t.jsxs(Ue,{className:"mt-3",children:[t.jsx(fe,{className:"text-[#1e7b4f] dark:text-[#7ce0b3]",children:ee(ue)}),t.jsx(fe,{className:`${xe>0?"text-[#1e7b4f] dark:text-[#7ce0b3]":xe<0?"text-[#b0352b] dark:text-[#ff8b7c]":"text-[#6a5d52] dark:text-white/70"}`,children:we(xe).replace(/^([+−-])/,"$1 ")}),t.jsx(Ce,{children:"−"}),t.jsx(fe,{className:"text-[#b0352b] dark:text-[#ff8b7c]",children:ee(ge)}),t.jsx(Ce,{children:"="}),t.jsx(fe,{className:`${ue+xe-ge>=0?"text-[#1e7b4f] dark:text-[#7ce0b3]":"text-[#b0352b] dark:text-[#ff8b7c]"}`,children:we(ue+xe-ge)})]}),t.jsx("div",{className:"mt-4 h-px w-full bg-black/10 dark:bg-white/10"}),t.jsx(ne,{className:"mt-4",children:"Фактическое среднее в день за период"}),t.jsx(Me,{className:"mt-2",children:ee(Je)})]})]})]}),de&&t.jsx(ht,{currentTitle:je,onCancel:()=>le(!1),onConfirm:()=>Le(!0),confirmDisabled:B}),ce&&t.jsx(bt,{onCancel:()=>D(!1),onConfirm:rt,confirmDisabled:Z}),$&&t.jsx(xt,{href:`/periods/${$.id}`,title:`${be($.start_date)} — ${be($.end_date)}`,subtitle:`${Ke($.start_date,$.end_date)} дней · ${Ye($.start_date,$.end_date)}`,onClose:()=>{F(null),T(!1),ke.current=null},onConfirm:()=>ie(!0,ke.current??void 0),confirmDisabled:!z||P}),A&&t.jsx("div",{className:"relative z-10 rounded-lg border border-black/10 bg-white/70 px-5 py-3 text-xs text-[#b0352b] dark:border-white/10 dark:bg-white/10 dark:text-[#ff8b7c]",children:A})]})]})}export{Mt as default};
