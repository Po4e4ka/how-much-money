import{c as se,j as t,r as f,u as lt,H as it,L as Be}from"./app-B6cE64wp.js";import{T as dt,a as ot,b as ct,A as xt}from"./app-layout-MCrjerFc.js";import{d as Ie}from"./index-BDqSilVs.js";import{P as Q,O as mt}from"./overlap-period-modal-DCicCrW6.js";import{b as ft}from"./app-logo-icon-DzjLqR-g.js";import{d as ut}from"./animation-DULAtfne.js";import{c as Me,b as ue,f as Le,a as Re}from"./date-C0FYGyP5.js";import{b as pt,d as Ve,e as ht,h as bt,i as ze,a as ee,j as be,k as gt,l as ve,t as ge}from"./period-calculations-B8wa10Pl.js";/* empty css            */import"./index-CeUv-TYW.js";import"./index-DjQKldez.js";const wt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],jt=ft("CircleHelp",wt),kt=h=>{const e=se.c(14),{currentTitle:l,onConfirm:i,onCancel:a,confirmDisabled:s}=h,d=s===void 0?!1:s;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=t.jsx("h3",{className:"font-display text-2xl",children:"Закрепить другой период?"}),e[0]=r):r=e[0];const o=l?`Сейчас закреплён период ${l}. Закрепить этот вместо него?`:"Сейчас уже есть закреплённый период. Закрепить этот вместо него?";let c;e[1]!==o?(c=t.jsx("p",{className:"mt-3 text-sm text-[#6a5d52] dark:text-white/70",children:o}),e[1]=o,e[2]=c):c=e[2];let p;e[3]!==a?(p=t.jsx(Q,{type:"button",onClick:a,className:"px-4 py-2",children:"Отмена"}),e[3]=a,e[4]=p):p=e[4];let g;e[5]!==d||e[6]!==i?(g=t.jsx(Q,{type:"button",onClick:i,tone:"success",className:"px-4 py-2",disabled:d,children:"Закрепить"}),e[5]=d,e[6]=i,e[7]=g):g=e[7];let x;e[8]!==p||e[9]!==g?(x=t.jsxs("div",{className:"mt-6 flex flex-wrap justify-end gap-3",children:[p,g]}),e[8]=p,e[9]=g,e[10]=x):x=e[10];let m;return e[11]!==c||e[12]!==x?(m=t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-6",children:t.jsxs("div",{className:"w-full max-w-xl rounded-lg border border-black/10 bg-white/95 p-6 text-[#1c1a17] shadow-[0_24px_60px_-28px_rgba(0,0,0,0.7)] dark:border-white/10 dark:bg-[#1c1a17] dark:text-white",children:[r,c,x]})}),e[11]=c,e[12]=x,e[13]=m):m=e[13],m},yt=h=>{const e=se.c(10),{onConfirm:l,onCancel:i,confirmDisabled:a}=h,s=a===void 0?!1:a;let d,r;e[0]===Symbol.for("react.memo_cache_sentinel")?(d=t.jsx("h3",{className:"font-display text-2xl",children:"Закрыть период?"}),r=t.jsx("p",{className:"mt-3 text-sm text-[#6a5d52] dark:text-white/70",children:"После закрытия период будет доступен только для просмотра. Редактировать данные больше нельзя."}),e[0]=d,e[1]=r):(d=e[0],r=e[1]);let o;e[2]!==i?(o=t.jsx(Q,{type:"button",onClick:i,className:"px-4 py-2",children:"Отмена"}),e[2]=i,e[3]=o):o=e[3];let c;e[4]!==s||e[5]!==l?(c=t.jsx(Q,{type:"button",onClick:l,tone:"success",className:"px-4 py-2",disabled:s,children:"Закрыть"}),e[4]=s,e[5]=l,e[6]=c):c=e[6];let p;return e[7]!==o||e[8]!==c?(p=t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 py-6",children:t.jsxs("div",{className:"w-full max-w-xl rounded-lg border border-black/10 bg-white/95 p-6 text-[#1c1a17] shadow-[0_24px_60px_-28px_rgba(0,0,0,0.7)] dark:border-white/10 dark:bg-[#1c1a17] dark:text-white",children:[d,r,t.jsxs("div",{className:"mt-6 flex flex-wrap justify-end gap-3",children:[o,c]})]})}),e[7]=o,e[8]=c,e[9]=p):p=e[9],p};function vt(h){const e=se.c(14),{text:l,ariaLabel:i}=h,[a,s]=f.useState(!1),[d,r]=f.useState(!1);let o,c;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=()=>{if(typeof window>"u")return;const S=window.matchMedia("(hover: none) and (pointer: coarse)"),E=()=>s(S.matches);return E(),S.addEventListener("change",E),()=>S.removeEventListener("change",E)},c=[],e[0]=o,e[1]=c):(o=e[0],c=e[1]),f.useEffect(o,c);const p=a?d:void 0,g=i??"Подсказка";let x;e[2]!==a?(x=()=>{a&&r(Nt)},e[2]=a,e[3]=x):x=e[3];let m;e[4]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx(jt,{className:"h-4 w-4"}),e[4]=m):m=e[4];let N;e[5]!==g||e[6]!==x?(N=t.jsx(dt,{asChild:!0,children:t.jsx("button",{type:"button","aria-label":g,className:"inline-flex h-5 w-5 items-center justify-center rounded-full text-[#6a5d52] transition hover:text-[#1c1a17] dark:text-white/60 dark:hover:text-white",onClick:x,children:m})}),e[5]=g,e[6]=x,e[7]=N):N=e[7];let u;e[8]!==l?(u=t.jsx(ot,{className:"max-w-xs text-xs leading-relaxed",children:l}),e[8]=l,e[9]=u):u=e[9];let w;return e[10]!==p||e[11]!==N||e[12]!==u?(w=t.jsxs(ct,{open:p,onOpenChange:r,children:[N,u]}),e[10]=p,e[11]=N,e[12]=u,e[13]=w):w=e[13],w}function Nt(h){return!h}const ne=h=>{const e=se.c(9),{children:l,className:i,tooltipText:a,tooltipAriaLabel:s}=h,d=`text-xs uppercase tracking-[0.3em] text-[#6a5d52] dark:text-white/60 ${i??""}`;let r;e[0]!==l?(r=t.jsx("span",{children:l}),e[0]=l,e[1]=r):r=e[1];let o;e[2]!==s||e[3]!==a?(o=a?t.jsx("span",{className:"ml-2 inline-flex align-middle",children:t.jsx(vt,{text:a,ariaLabel:s??"Дополнительная информация"})}):null,e[2]=s,e[3]=a,e[4]=o):o=e[4];let c;return e[5]!==d||e[6]!==r||e[7]!==o?(c=t.jsxs("div",{className:d,children:[r,o]}),e[5]=d,e[6]=r,e[7]=o,e[8]=c):c=e[8],c},Te=h=>{const e=se.c(3),{children:l,className:i}=h,a=`font-display text-2xl ${i??""}`;let s;return e[0]!==l||e[1]!==a?(s=t.jsx("div",{className:a,children:l}),e[0]=l,e[1]=a,e[2]=s):s=e[2],s},_t={id:0,startDate:"",endDate:"",incomes:[],expenses:[],offIncomeExpenses:[],dailyExpenses:{},isPinned:!1,isClosed:!1},qe=h=>{const e=se.c(3),{children:l,className:i}=h,a=`flex flex-wrap items-center gap-2 text-xs font-semibold sm:text-sm ${i??""}`;let s;return e[0]!==l||e[1]!==a?(s=t.jsx("div",{className:a,children:l}),e[0]=l,e[1]=a,e[2]=s):s=e[2],s},xe=h=>{const e=se.c(3),{children:l,className:i}=h,a=`inline-flex items-center font-display tabular-nums leading-[0.9] ${i??""}`;let s;return e[0]!==l||e[1]!==a?(s=t.jsx("span",{className:a,children:l}),e[0]=l,e[1]=a,e[2]=s):s=e[2],s},Ne=h=>{const e=se.c(3),{children:l,className:i}=h,a=`inline-flex items-center leading-[0.9] relative -top-[1px] text-black/50 dark:text-white/60 ${i??""}`;let s;return e[0]!==l||e[1]!==a?(s=t.jsx("span",{className:a,children:l}),e[0]=l,e[1]=a,e[2]=s):s=e[2],s},Ct=h=>{const e=se.c(51),{items:l,setItems:i,totalAmount:a,onAdd:s,showDelete:d,onToggleDelete:r,onBlurField:o,onAfterDelete:c,invalidNameIds:p,readOnly:g}=h,x=g===void 0?!1:g;let m;e[0]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx(ne,{children:"Приход"}),e[0]=m):m=e[0];let N;e[1]!==s||e[2]!==x?(N=t.jsx(Q,{type:"button",onClick:s,disabled:x,children:"+ Строка"}),e[1]=s,e[2]=x,e[3]=N):N=e[3];let u;e[4]!==r||e[5]!==x||e[6]!==d?(u=t.jsx(Q,{type:"button",onClick:r,active:d,activeTone:"danger",disabled:x,children:"− Удаление"}),e[4]=r,e[5]=x,e[6]=d,e[7]=u):u=e[7];let w;e[8]!==N||e[9]!==u?(w=t.jsxs("div",{className:"flex items-center justify-between",children:[m,t.jsxs("div",{className:"flex items-center gap-2",children:[N,u]})]}),e[8]=N,e[9]=u,e[10]=w):w=e[10];const S=`mt-3 hidden items-center gap-2 text-[11px] uppercase tracking-[0.2em] text-[#6a5d52] dark:text-white/60 sm:grid ${d?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)]"}`;let E,L;e[11]===Symbol.for("react.memo_cache_sentinel")?(E=t.jsx("span",{children:"Название"}),L=t.jsx("span",{className:"text-right",children:"Сумма"}),e[11]=E,e[12]=L):(E=e[11],L=e[12]);let F;e[13]!==d?(F=d&&t.jsx("span",{className:"text-center",children:"—"}),e[13]=d,e[14]=F):F=e[14];let B;e[15]!==S||e[16]!==F?(B=t.jsxs("div",{className:S,children:[E,L,F]}),e[15]=S,e[16]=F,e[17]=B):B=e[17];let K;if(e[18]!==p||e[19]!==l||e[20]!==c||e[21]!==o||e[22]!==x||e[23]!==i||e[24]!==d){let U;e[26]!==p||e[27]!==c||e[28]!==o||e[29]!==x||e[30]!==i||e[31]!==d?(U=(k,Z)=>t.jsxs("div",{className:`grid items-center gap-2 ${d?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)]"}`,children:[t.jsx("input",{type:"text",placeholder:`Приход ${Z+1}`,value:k.name,disabled:x,onChange:_=>i(b=>b.map(X=>X.id===k.id?{...X,name:_.target.value}:X)),onBlur:o,className:`rounded-lg border bg-white/90 px-3 py-2 text-xs dark:bg-white/10 sm:px-4 sm:text-sm ${p.includes(k.id)?"border-[#b0352b] dark:border-[#ff8b7c]":"border-black/10 dark:border-white/10"}`}),t.jsx("input",{type:"number",min:0,step:1,inputMode:"numeric",value:k.amount,disabled:x,onChange:_=>{const b=_.target.value;i(X=>X.map(M=>M.id===k.id?{...M,amount:ge(b)}:M))},onFocus:()=>{k.amount===0&&i(_=>_.map(b=>b.id===k.id?{...b,amount:""}:b))},onBlur:()=>{k.amount===""&&i(_=>_.map(b=>b.id===k.id?{...b,amount:0}:b)),o()},className:"no-spin rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs text-right tabular-nums dark:border-white/10 dark:bg-white/10 sm:px-4 sm:text-sm"}),d&&t.jsx("button",{type:"button",onClick:()=>{window.confirm("Удалить строку?")&&(i(_=>_.filter(b=>b.id!==k.id)),c())},"aria-label":`Удалить приход ${Z+1}`,className:"flex h-8 w-8 items-center justify-center rounded-full text-xs text-[#b0352b] transition hover:bg-[#b0352b]/10 dark:text-[#ff8b7c] dark:hover:bg-[#ff8b7c]/15",disabled:x,children:"—"})]},k.id),e[26]=p,e[27]=c,e[28]=o,e[29]=x,e[30]=i,e[31]=d,e[32]=U):U=e[32],K=l.map(U),e[18]=p,e[19]=l,e[20]=c,e[21]=o,e[22]=x,e[23]=i,e[24]=d,e[25]=K}else K=e[25];let T;e[33]!==K?(T=t.jsx("div",{className:"mt-3 grid gap-2",children:K}),e[33]=K,e[34]=T):T=e[34];const H=`mt-3 grid items-center gap-2 rounded-lg border border-dashed border-black/10 bg-white/70 px-4 py-2 text-xs dark:border-white/10 dark:bg-white/5 ${d?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)]"}`;let A;e[35]===Symbol.for("react.memo_cache_sentinel")?(A=t.jsx("span",{children:"Итого прихода"}),e[35]=A):A=e[35];let O;e[36]!==a?(O=ee(a),e[36]=a,e[37]=O):O=e[37];let V;e[38]!==O?(V=t.jsx("span",{className:"text-right font-display text-sm tabular-nums",children:O}),e[38]=O,e[39]=V):V=e[39];let I;e[40]!==d?(I=d&&t.jsx("span",{}),e[40]=d,e[41]=I):I=e[41];let $;e[42]!==H||e[43]!==V||e[44]!==I?($=t.jsxs("div",{className:H,children:[A,V,I]}),e[42]=H,e[43]=V,e[44]=I,e[45]=$):$=e[45];let j;return e[46]!==B||e[47]!==T||e[48]!==$||e[49]!==w?(j=t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/80 px-5 py-4 text-sm shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-white/10",children:[w,B,T,$]}),e[46]=B,e[47]=T,e[48]=$,e[49]=w,e[50]=j):j=e[50],j},Dt=h=>{const e=se.c(71),{title:l,items:i,setItems:a,showDelete:s,onToggleDelete:d,totalLabel:r,totalPlanned:o,totalActual:c,totalDifference:p,idPrefix:g,onBlurField:x,onAfterDelete:m,readOnly:N}=h,u=N===void 0?!1:N;let w;e[0]!==l?(w=t.jsx(ne,{children:l}),e[0]=l,e[1]=w):w=e[1];let S;e[2]!==g||e[3]!==a?(S=()=>a(oe=>[...oe,{id:`${g}${Date.now()}`,name:"",plannedAmount:"",actualAmount:"",actualTouched:!1}]),e[2]=g,e[3]=a,e[4]=S):S=e[4];let E;e[5]!==u||e[6]!==S?(E=t.jsx(Q,{type:"button",onClick:S,disabled:u,children:"+ Строка"}),e[5]=u,e[6]=S,e[7]=E):E=e[7];let L;e[8]!==d||e[9]!==u||e[10]!==s?(L=t.jsx(Q,{type:"button",onClick:d,active:s,activeTone:"danger",disabled:u,children:"− Удаление"}),e[8]=d,e[9]=u,e[10]=s,e[11]=L):L=e[11];let F;e[12]!==E||e[13]!==L?(F=t.jsxs("div",{className:"flex items-center gap-2",children:[E,L]}),e[12]=E,e[13]=L,e[14]=F):F=e[14];let B;e[15]!==w||e[16]!==F?(B=t.jsxs("div",{className:"flex items-center justify-between",children:[w,F]}),e[15]=w,e[16]=F,e[17]=B):B=e[17];const K=`mt-3 grid items-center gap-2 text-[11px] uppercase tracking-[0.2em] text-[#6a5d52] dark:text-white/60 ${s?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_minmax(0,0.7fr)]"}`;let T,H,A;e[18]===Symbol.for("react.memo_cache_sentinel")?(A=t.jsxs("span",{children:[t.jsx("span",{className:"sm:hidden",children:"Название"}),t.jsx("span",{className:"hidden sm:inline",children:"Название"})]}),T=t.jsx("span",{className:"text-right",children:"План"}),H=t.jsx("span",{className:"text-right",children:"Факт"}),e[18]=T,e[19]=H,e[20]=A):(T=e[18],H=e[19],A=e[20]);let O;e[21]===Symbol.for("react.memo_cache_sentinel")?(O=t.jsxs("span",{className:"text-right",children:[t.jsx("span",{className:"sm:hidden",children:"Разн"}),t.jsx("span",{className:"hidden sm:inline",children:"Разница"})]}),e[21]=O):O=e[21];let V;e[22]!==s?(V=s&&t.jsx("span",{className:"text-center",children:"—"}),e[22]=s,e[23]=V):V=e[23];let I;e[24]!==V||e[25]!==K?(I=t.jsxs("div",{className:K,children:[A,T,H,O,V]}),e[24]=V,e[25]=K,e[26]=I):I=e[26];let $;if(e[27]!==i||e[28]!==m||e[29]!==x||e[30]!==u||e[31]!==a||e[32]!==s){let oe;e[34]!==m||e[35]!==x||e[36]!==u||e[37]!==a||e[38]!==s?(oe=(C,we)=>t.jsxs("div",{className:`grid items-center gap-2 ${s?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_minmax(0,0.7fr)]"}`,children:[t.jsx("input",{type:"text",placeholder:`Трата ${we+1}`,value:C.name,disabled:u,onChange:z=>a(y=>y.map(ae=>ae.id===C.id?{...ae,name:z.target.value}:ae)),onBlur:x,className:"rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs dark:border-white/10 dark:bg-white/10 sm:px-4 sm:text-sm"}),t.jsx("input",{type:"number",min:0,step:1,inputMode:"numeric",value:C.plannedAmount,disabled:u,onChange:z=>{const y=z.target.value;a(ae=>ae.map(te=>te.id===C.id?{...te,plannedAmount:ge(y),actualAmount:te.actualTouched?te.actualAmount:ge(y)}:te))},onFocus:()=>{C.plannedAmount===0&&a(z=>z.map(y=>y.id===C.id?{...y,plannedAmount:""}:y))},onBlur:()=>{C.plannedAmount===""&&a(z=>z.map(y=>y.id===C.id?{...y,plannedAmount:0}:y)),x()},className:"no-spin rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs text-right tabular-nums dark:border-white/10 dark:bg-white/10 sm:px-4 sm:text-sm"}),t.jsx("input",{type:"number",min:0,step:1,inputMode:"numeric",value:C.actualAmount,disabled:u,onChange:z=>{const y=z.target.value;a(ae=>ae.map(te=>te.id===C.id?{...te,actualAmount:ge(y),actualTouched:!0}:te))},onFocus:()=>{C.actualAmount===0&&a(z=>z.map(y=>y.id===C.id?{...y,actualAmount:""}:y))},onBlur:()=>{C.actualAmount===""&&a(z=>z.map(y=>y.id===C.id?{...y,actualAmount:0}:y)),x()},className:"no-spin rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs text-right tabular-nums dark:border-white/10 dark:bg-white/10 sm:px-4 sm:text-sm"}),t.jsx("div",{className:`flex min-h-[36px] items-center justify-end px-0 py-2 text-xs tabular-nums sm:min-h-[40px] sm:px-4 sm:text-sm ${C.plannedAmount-C.actualAmount>0?"text-[#1e7b4f] dark:text-[#7ce0b3]":C.plannedAmount-C.actualAmount<0?"text-[#b0352b] dark:text-[#ff8b7c]":"text-[#6a5d52] dark:text-white/70"}`,children:be(C.plannedAmount-C.actualAmount)}),s&&t.jsx("button",{type:"button",onClick:()=>{window.confirm("Удалить строку?")&&(a(z=>z.filter(y=>y.id!==C.id)),m())},"aria-label":`Удалить трату ${we+1}`,className:"flex h-8 w-8 items-center justify-center rounded-full text-xs text-[#b0352b] transition hover:bg-[#b0352b]/10 dark:text-[#ff8b7c] dark:hover:bg-[#ff8b7c]/15",disabled:u,children:"—"})]},C.id),e[34]=m,e[35]=x,e[36]=u,e[37]=a,e[38]=s,e[39]=oe):oe=e[39],$=i.map(oe),e[27]=i,e[28]=m,e[29]=x,e[30]=u,e[31]=a,e[32]=s,e[33]=$}else $=e[33];let j;e[40]!==$?(j=t.jsx("div",{className:"mt-3 grid gap-2",children:$}),e[40]=$,e[41]=j):j=e[41];const U=`mt-3 grid items-center gap-2 rounded-lg border border-dashed border-black/10 bg-white/70 px-4 py-2 text-xs dark:border-white/10 dark:bg-white/5 ${s?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_minmax(0,0.7fr)_minmax(0,0.7fr)]"}`;let k;e[42]!==r?(k=t.jsx("span",{children:r}),e[42]=r,e[43]=k):k=e[43];let Z;e[44]!==o?(Z=ee(o),e[44]=o,e[45]=Z):Z=e[45];let _;e[46]!==Z?(_=t.jsx("span",{className:"text-right font-display text-sm tabular-nums",children:Z}),e[46]=Z,e[47]=_):_=e[47];let b;e[48]!==c?(b=ee(c),e[48]=c,e[49]=b):b=e[49];let X;e[50]!==b?(X=t.jsx("span",{className:"text-right font-display text-sm tabular-nums",children:b}),e[50]=b,e[51]=X):X=e[51];const M=`text-right font-display text-sm tabular-nums ${p>0?"text-[#1e7b4f] dark:text-[#7ce0b3]":p<0?"text-[#b0352b] dark:text-[#ff8b7c]":"text-[#6a5d52] dark:text-white/70"}`;let P;e[52]!==p?(P=be(p),e[52]=p,e[53]=P):P=e[53];let G;e[54]!==M||e[55]!==P?(G=t.jsx("span",{className:M,children:P}),e[54]=M,e[55]=P,e[56]=G):G=e[56];let W;e[57]!==s?(W=s&&t.jsx("span",{}),e[57]=s,e[58]=W):W=e[58];let de;e[59]!==U||e[60]!==k||e[61]!==_||e[62]!==X||e[63]!==G||e[64]!==W?(de=t.jsxs("div",{className:U,children:[k,_,X,G,W]}),e[59]=U,e[60]=k,e[61]=_,e[62]=X,e[63]=G,e[64]=W,e[65]=de):de=e[65];let re;return e[66]!==I||e[67]!==j||e[68]!==de||e[69]!==B?(re=t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/80 px-5 py-4 text-sm shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-white/10",children:[B,I,j,de]}),e[66]=I,e[67]=j,e[68]=de,e[69]=B,e[70]=re):re=e[70],re},St=h=>{const e=se.c(58),{title:l,items:i,setItems:a,showDelete:s,onToggleDelete:d,totalLabel:r,totalAmount:o,idPrefix:c,onBlurField:p,onAfterDelete:g,readOnly:x}=h,m=x===void 0?!1:x;let N;e[0]!==l?(N=t.jsx(ne,{tooltipText:"Эти траты не учитываются в расчётах.",tooltipAriaLabel:"Сторонние траты",children:l}),e[0]=l,e[1]=N):N=e[1];let u;e[2]!==c||e[3]!==a?(u=()=>a(_=>[..._,{id:`${c}${Date.now()}`,name:"",amount:""}]),e[2]=c,e[3]=a,e[4]=u):u=e[4];let w;e[5]!==m||e[6]!==u?(w=t.jsx(Q,{type:"button",onClick:u,disabled:m,children:"+ Строка"}),e[5]=m,e[6]=u,e[7]=w):w=e[7];let S;e[8]!==d||e[9]!==m||e[10]!==s?(S=t.jsx(Q,{type:"button",onClick:d,active:s,activeTone:"danger",disabled:m,children:"− Удаление"}),e[8]=d,e[9]=m,e[10]=s,e[11]=S):S=e[11];let E;e[12]!==w||e[13]!==S?(E=t.jsxs("div",{className:"flex items-center gap-2",children:[w,S]}),e[12]=w,e[13]=S,e[14]=E):E=e[14];let L;e[15]!==N||e[16]!==E?(L=t.jsxs("div",{className:"flex items-center justify-between",children:[N,E]}),e[15]=N,e[16]=E,e[17]=L):L=e[17];const F=`mt-3 hidden items-center gap-2 text-[11px] uppercase tracking-[0.2em] text-[#6a5d52] dark:text-white/60 sm:grid ${s?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)]"}`;let B,K;e[18]===Symbol.for("react.memo_cache_sentinel")?(K=t.jsx("span",{children:"Название"}),B=t.jsx("span",{className:"text-right",children:"Сумма"}),e[18]=B,e[19]=K):(B=e[18],K=e[19]);let T;e[20]!==s?(T=s&&t.jsx("span",{className:"text-center",children:"—"}),e[20]=s,e[21]=T):T=e[21];let H;e[22]!==T||e[23]!==F?(H=t.jsxs("div",{className:F,children:[K,B,T]}),e[22]=T,e[23]=F,e[24]=H):H=e[24];let A;if(e[25]!==i||e[26]!==g||e[27]!==p||e[28]!==m||e[29]!==a||e[30]!==s){let _;e[32]!==g||e[33]!==p||e[34]!==m||e[35]!==a||e[36]!==s?(_=(b,X)=>t.jsxs("div",{className:`grid items-center gap-2 ${s?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)]"}`,children:[t.jsx("input",{type:"text",placeholder:`Трата ${X+1}`,value:b.name,disabled:m,onChange:M=>a(P=>P.map(G=>G.id===b.id?{...G,name:M.target.value}:G)),onBlur:p,className:"rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs dark:border-white/10 dark:bg-white/10 sm:px-4 sm:text-sm"}),t.jsx("input",{type:"number",min:0,step:1,inputMode:"numeric",value:b.amount,disabled:m,onChange:M=>{const P=M.target.value;a(G=>G.map(W=>W.id===b.id?{...W,amount:ge(P)}:W))},onFocus:()=>{b.amount===0&&a(M=>M.map(P=>P.id===b.id?{...P,amount:""}:P))},onBlur:()=>{b.amount===""&&a(M=>M.map(P=>P.id===b.id?{...P,amount:0}:P)),p()},className:"no-spin rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs text-right tabular-nums text-[#b0352b] dark:border-white/10 dark:bg-white/10 dark:text-[#ff8b7c] sm:px-4 sm:text-sm"}),s&&t.jsx("button",{type:"button",onClick:()=>{window.confirm("Удалить строку?")&&(a(M=>M.filter(P=>P.id!==b.id)),g())},"aria-label":`Удалить трату ${X+1}`,className:"flex h-8 w-8 items-center justify-center rounded-full text-xs text-[#b0352b] transition hover:bg-[#b0352b]/10 dark:text-[#ff8b7c] dark:hover:bg-[#ff8b7c]/15",disabled:m,children:"—"})]},b.id),e[32]=g,e[33]=p,e[34]=m,e[35]=a,e[36]=s,e[37]=_):_=e[37],A=i.map(_),e[25]=i,e[26]=g,e[27]=p,e[28]=m,e[29]=a,e[30]=s,e[31]=A}else A=e[31];let O;e[38]!==A?(O=t.jsx("div",{className:"mt-3 grid gap-2",children:A}),e[38]=A,e[39]=O):O=e[39];const V=`mt-3 grid items-center gap-2 rounded-lg border border-dashed border-black/10 bg-white/70 px-4 py-2 text-xs dark:border-white/10 dark:bg-white/5 ${s?"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)_auto]":"grid-cols-[minmax(0,1.2fr)_minmax(0,0.7fr)]"}`;let I;e[40]!==r?(I=t.jsx("span",{children:r}),e[40]=r,e[41]=I):I=e[41];let $;e[42]!==o?($=ee(o),e[42]=o,e[43]=$):$=e[43];let j;e[44]!==$?(j=t.jsx("span",{className:"text-right font-display text-sm tabular-nums text-[#b0352b] dark:text-[#ff8b7c]",children:$}),e[44]=$,e[45]=j):j=e[45];let U;e[46]!==s?(U=s&&t.jsx("span",{}),e[46]=s,e[47]=U):U=e[47];let k;e[48]!==V||e[49]!==I||e[50]!==j||e[51]!==U?(k=t.jsxs("div",{className:V,children:[I,j,U]}),e[48]=V,e[49]=I,e[50]=j,e[51]=U,e[52]=k):k=e[52];let Z;return e[53]!==H||e[54]!==O||e[55]!==k||e[56]!==L?(Z=t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/80 px-5 py-4 text-sm shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-white/10",children:[L,H,O,k]}),e[53]=H,e[54]=O,e[55]=k,e[56]=L,e[57]=Z):Z=e[57],Z};function Rt(){const{periodId:h}=lt().props,[e,l]=f.useState(_t),[i,a]=f.useState([]),[s,d]=f.useState(""),[r,o]=f.useState(""),[c,p]=f.useState([]),[g,x]=f.useState([]),[m,N]=f.useState({}),[u,w]=f.useState(!1),[S,E]=f.useState(!1),[L,F]=f.useState(!0),[B,K]=f.useState(null),[T,H]=f.useState(!1),[A,O]=f.useState(null),[V,I]=f.useState(!1),[$,j]=f.useState(null),[U,k]=f.useState(!1),[Z,_]=f.useState([]),[b,X]=f.useState(!1),[M,P]=f.useState(!1),[G,W]=f.useState(!1),[de,re]=f.useState(!1),[oe,C]=f.useState(!1),[we,z]=f.useState(),y=f.useRef(!1),[ae,te]=f.useState(0),Pe="Заполните названия прихода.",me=f.useRef(null),je=f.useRef(null),Oe=f.useMemo(()=>`period:${h}`,[h]),_e=f.useRef(!1),Ce=f.useRef(!1),Ke=()=>typeof window>"u"?null:window.__periodCache?.[Oe]??null,ke=n=>{if(typeof window>"u")return;const v=window;v.__periodCache||(v.__periodCache={}),v.__periodCache[Oe]=n},{totalPlanned:De,totalActual:He,totalDifference:ce}=pt(c??[]),Xe=Ve(g??[]),Se=Ve(i??[]),ye=f.useMemo(()=>!s||!r?0:Me(s,r),[s,r]),pe=f.useMemo(()=>ht(m),[m]),Ae=f.useMemo(()=>bt(s,r,m),[m,s,r]),Je=Ae>0?pe/Ae:0,$e=f.useMemo(()=>!s||!r?"Период":`${ue(s)} — ${ue(r)}`,[s,r]),Ue=f.useMemo(()=>!s||!r?"":`${ye} дней · ${Le(s,r)}`,[ye,s,r]),{plannedPeriodSum:he,dailyAverage:Ze,actualRemaining:Ge,remainingDays:Qe,remainingDailyAverage:We,isDailyComplete:Ye}=gt({days:ye,totalIncome:Se,totalPlannedExpenses:De,totalDifference:ce,totalDailyExpenses:pe,filledDays:Ae}),fe=e.isClosed,et=[{title:"Dashboard",href:Ie().url},{title:$e,href:`/periods/${h}`}],tt=n=>!!(n&&n.id&&Array.isArray(n.incomes)&&Array.isArray(n.expenses)&&Array.isArray(n.offIncomeExpenses)),st=async()=>{if(Ce.current)return;const n=Ke();if(!(tt(n)&&(l({...n,isClosed:!!n.isClosed}),a(n.incomes??[]),d(n.startDate??""),o(n.endDate??""),p(n.expenses??[]),x(n.offIncomeExpenses??[]),N(n.dailyExpenses??{}),me.current={startDate:n.startDate??"",endDate:n.endDate??""},F(!1),typeof navigator<"u"&&!navigator.onLine))&&!(_e.current&&(!navigator.onLine||!n))){Ce.current=!0,F(!0),K(null);try{const v=await fetch(`/api/periods/${h}`);if(!v.ok)throw new Error("Не удалось загрузить период.");const q=(await v.json()).data,J={id:q.id,startDate:q.start_date,endDate:q.end_date,dailyExpenses:q.daily_expenses??{},isPinned:!!q.is_pinned,isClosed:!!q.is_closed,incomes:q.incomes.map(R=>({id:String(R.id),name:R.name,amount:R.amount})),expenses:q.expenses.map(R=>({id:String(R.id),name:R.name,plannedAmount:R.planned_amount,actualAmount:R.actual_amount,actualTouched:!1})),offIncomeExpenses:q.external_expenses.map(R=>({id:String(R.id),name:R.name,amount:R.amount}))};l(J),a(J.incomes),d(J.startDate),o(J.endDate),p(J.expenses),x(J.offIncomeExpenses),N(J.dailyExpenses),re(!1),z(void 0),me.current={startDate:J.startDate,endDate:J.endDate},ke(J),_e.current=!0}catch(v){K(v instanceof Error?v.message:"Не удалось загрузить период.")}finally{F(!1),Ce.current=!1}}},le=async(n=!1,v)=>{if(e.isClosed)return;const Y=v?.startDate??s,q=v?.endDate??r,J=ze(i);if(J.length>0){_(J),j(Pe);return}if(T){y.current=!0;return}H(!0),j(null),k(!1);try{const R=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")??"",ie=await fetch(`/api/periods/${h}`,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":R},body:JSON.stringify({start_date:Y,end_date:q,daily_expenses:m,force:n,incomes:i.filter(D=>D.name.trim()!=="").map(D=>({id:Number.isFinite(Number(D.id))?Number(D.id):void 0,name:D.name,amount:ve(D.amount)})),expenses:c.filter(D=>D.name.trim()!=="").map(D=>({id:Number.isFinite(Number(D.id))?Number(D.id):void 0,name:D.name,planned_amount:ve(D.plannedAmount),actual_amount:ve(D.actualAmount)})),external_expenses:g.filter(D=>D.name.trim()!=="").map(D=>({id:Number.isFinite(Number(D.id))?Number(D.id):void 0,name:D.name,amount:ve(D.amount)}))})});if(ie.status===409){const D=await ie.json();if(D.overlap){je.current={startDate:Y,endDate:q},O(D.overlap),I(!0),me.current&&(d(me.current.startDate),o(me.current.endDate));return}throw new Error("Период пересекается с существующим.")}if(!ie.ok){if(ie.status===423){const D=await ie.json();throw new Error(D.message??"Период закрыт и не редактируется.")}throw new Error("Не удалось сохранить период.")}d(Y),o(q),k(!0),O(null),I(!1),je.current=null,me.current={startDate:Y,endDate:q},ke({id:Number(h),startDate:Y,endDate:q,incomes:i,expenses:c,offIncomeExpenses:g,dailyExpenses:m,isPinned:e.isPinned,isClosed:e.isClosed})}catch(R){j(R instanceof Error?R.message:"Не удалось сохранить период.")}finally{H(!1)}},at=()=>{e.isClosed||(a(n=>[...n,{id:`i${Date.now()}`,name:"",amount:""}]),le())},Ee=()=>{te(n=>n+1)},nt=async()=>{if(!b&&window.confirm("Удалить период?")){X(!0),j(null);try{const n=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")??"";if(!(await fetch(`/api/periods/${h}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":n}})).ok)throw new Error("Не удалось удалить период.");window.location.href=Ie().url}catch(n){j(n instanceof Error?n.message:"Не удалось удалить период.")}finally{X(!1)}}},rt=async()=>{if(!(G||e.isClosed)){W(!0),j(null);try{const n=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")??"",v=await fetch(`/api/periods/${h}/close`,{method:"POST",headers:{"X-CSRF-TOKEN":n}});if(!v.ok){const J=await v.json();throw new Error(J.message??"Не удалось закрыть период.")}const Y=await v.json(),q={...e,isClosed:Y.data?.is_closed??!0};l(q),C(!1),ke({id:Number(h),startDate:s,endDate:r,incomes:i,expenses:c,offIncomeExpenses:g,dailyExpenses:m,isPinned:e.isPinned,isClosed:q.isClosed})}catch(n){j(n instanceof Error?n.message:"Не удалось закрыть период.")}finally{W(!1)}}},Fe=async(n=!1)=>{if(!M){P(!0);try{const v=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")??"",Y=await fetch(`/api/periods/${h}/pin`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":v},body:JSON.stringify({pinned:!e.isPinned,force:n})});if(Y.status===409){const ie=await Y.json();ie.pinned?z(`${ue(ie.pinned.start_date)} — ${ue(ie.pinned.end_date)}`):z(void 0),re(!0);return}if(!Y.ok)throw new Error("Не удалось изменить закрепление периода.");const J=(await Y.json()).data?.is_pinned??!e.isPinned,R={...e,isPinned:J};l(R),ke(R),re(!1)}catch(v){j(v instanceof Error?v.message:"Не удалось изменить закрепление периода.")}finally{P(!1)}}};return f.useEffect(()=>{_e.current=!1,st()},[h]),f.useEffect(()=>{!T&&y.current&&(y.current=!1,le())},[T]),f.useEffect(()=>{ae>0&&le()},[ae]),f.useEffect(()=>{const n=ze(i);_(n),n.length===0&&$===Pe&&j(null)},[i,$]),t.jsxs(xt,{breadcrumbs:et,children:[t.jsx(it,{title:$e}),t.jsxs("div",{className:`relative flex flex-1 flex-col gap-8 overflow-x-hidden rounded-xl p-3 font-body text-[#1c1a17] dark:text-[#f7f3ee]${e.isClosed?" bg-emerald-50/70 dark:bg-emerald-950/20":""}`,children:[t.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-3xl bg-aurora opacity-35 dark:hidden"}),t.jsx("div",{className:"pointer-events-none absolute inset-0 hidden rounded-3xl bg-aurora-night opacity-45 dark:block"}),t.jsxs("section",{className:"relative z-10 flex flex-wrap items-center justify-between gap-6",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-[#6a5d52] dark:text-white/60",children:"Период"}),t.jsx("h1",{className:"mt-3 font-display text-3xl",children:$e}),t.jsx("p",{className:"mt-2 text-sm text-[#6a5d52] dark:text-white/70",children:Ue})]}),e.isClosed&&t.jsx("div",{className:"flex-1 text-center text-sm font-semibold text-emerald-600 dark:text-emerald-300",children:"Период закрыт"}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[!e.isClosed&&t.jsx(Q,{type:"button",onClick:()=>Fe(!1),tone:e.isPinned?"danger":"success",disabled:M,className:"px-4 py-2",children:e.isPinned?"Открепить":"Закрепить"}),Ye&&!e.isClosed&&t.jsx(Q,{type:"button",onClick:()=>C(!0),disabled:G,tone:"success",className:"px-4 py-2",children:"Закрыть период"}),t.jsx(Q,{type:"button",onClick:nt,disabled:b,tone:"danger",className:"px-4 py-2",children:"Удалить"}),t.jsx(Be,{href:Ie(),prefetch:!0,className:"rounded-full border border-black/10 bg-white/80 px-4 py-2 text-xs text-[#1c1a17] shadow-[0_16px_32px_-24px_rgba(28,26,23,0.6)] transition hover:-translate-y-0.5 dark:border-white/10 dark:bg-white/10 dark:text-white",children:"← Ко всем периодам"})]})]}),t.jsxs("section",{className:"relative z-10 grid gap-6 lg:grid-cols-[1.1fr_0.9fr] lg:items-start animate-reveal",style:ut(120),children:[L&&t.jsx("div",{className:"col-span-full rounded-lg border border-black/10 bg-white/70 px-5 py-4 text-sm text-[#6a5d52] dark:border-white/10 dark:bg-white/10 dark:text-white/70",children:"Загружаем период..."}),B&&t.jsx("div",{className:"col-span-full rounded-lg border border-black/10 bg-white/70 px-5 py-4 text-sm text-[#b0352b] dark:border-white/10 dark:bg-white/10 dark:text-[#ff8b7c]",children:B}),t.jsxs("div",{className:"order-2 grid gap-4 lg:order-none lg:self-start",children:[t.jsx(Ct,{items:i,setItems:a,totalAmount:Se,onAdd:at,showDelete:u,onToggleDelete:()=>w(n=>!n),onBlurField:le,onAfterDelete:Ee,invalidNameIds:Z,readOnly:fe}),t.jsx(Dt,{title:"Обязательные траты",items:c,setItems:p,showDelete:u,onToggleDelete:()=>w(n=>!n),totalLabel:"Итого обязательных",totalPlanned:De,totalActual:He,totalDifference:ce,idPrefix:"e",onBlurField:le,onAfterDelete:Ee,readOnly:fe}),t.jsx(St,{title:"Сторонние траты",items:g,setItems:x,showDelete:u,onToggleDelete:()=>w(n=>!n),totalLabel:"Итого сторонних",totalAmount:Xe,idPrefix:"o",onBlurField:le,onAfterDelete:Ee,readOnly:fe})]}),t.jsxs("div",{className:"order-1 grid gap-4 lg:order-none lg:self-start",children:[t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/80 px-5 py-4 text-sm shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-white/10",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(ne,{children:"Дни периода"}),t.jsx(Q,{type:"button",onClick:()=>E(n=>!n),active:S,activeTone:"success",disabled:fe,children:S?"Готово":"Редактировать"})]}),t.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[t.jsx("div",{className:"px-1 text-base font-semibold tabular-nums",children:ye}),t.jsx("span",{className:"text-xs text-[#6a5d52] dark:text-white/60",children:"дней"})]}),S&&t.jsxs("div",{className:"mt-3 grid gap-2 grid-cols-2",children:[t.jsxs("label",{className:"grid gap-1 text-xs text-[#6a5d52] dark:text-white/60",children:["Начало",t.jsx("input",{type:"date",value:s,disabled:fe,onChange:n=>{const v=n.target.value;d(v),le(!1,{startDate:v})},min:r?Re(r,-3):void 0,max:r,className:"rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs dark:border-white/10 dark:bg-white/10 sm:text-sm"})]}),t.jsxs("label",{className:"grid gap-1 text-xs text-[#6a5d52] dark:text-white/60",children:["Конец",t.jsx("input",{type:"date",value:r,disabled:fe,onChange:n=>{const v=n.target.value;o(v),le(!1,{endDate:v})},min:s,max:s?Re(s,3):void 0,className:"rounded-lg border border-black/10 bg-white/90 px-3 py-2 text-xs dark:border-white/10 dark:bg-white/10 sm:text-sm"})]})]})]}),t.jsx(Be,{href:`/periods/${h}/daily`,prefetch:!0,className:"group rounded-lg border border-[#1e7b4f]/30 bg-white/90 px-5 py-4 text-sm text-[#1c1a17] shadow-[0_24px_48px_-28px_rgba(30,123,79,0.55)] transition hover:-translate-y-0.5 hover:shadow-[0_28px_60px_-30px_rgba(30,123,79,0.65)] dark:border-[#7ce0b3]/30 dark:bg-white/10 dark:text-white",children:t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsx(ne,{children:"Ежедневные траты"}),t.jsx(Q,{as:"span",children:"Перейти к дневным значениям"})]})}),t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/85 px-5 py-6 text-[#1c1a17] shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-[#1c1a17] dark:text-white dark:shadow-[0_20px_40px_-26px_rgba(0,0,0,0.7)]",children:[t.jsx(ne,{children:"Планируемое среднее в день"}),t.jsx("p",{className:"mt-2 text-xs text-[#6a5d52] dark:text-white/60",children:"(Приход − обязательные) / дни"}),t.jsx(Te,{className:"mt-3",children:ee(Ze)}),t.jsxs("div",{className:"mt-4 grid gap-3 text-xs text-[#6a5d52] dark:text-white/70",children:[t.jsx("div",{className:"h-px w-full bg-black/10 dark:bg-white/10"}),t.jsx(ne,{children:"Планируемая сумма на период"}),t.jsxs(qe,{children:[t.jsx(xe,{className:"text-[#1e7b4f] dark:text-[#7ce0b3]",children:ee(Se)}),t.jsx(Ne,{children:"−"}),t.jsx(xe,{className:"text-[#b0352b] dark:text-[#ff8b7c]",children:ee(De)}),t.jsx(Ne,{children:"="}),t.jsx(xe,{className:`${he>=0?"text-[#1e7b4f] dark:text-[#7ce0b3]":"text-[#b0352b] dark:text-[#ff8b7c]"}`,children:be(he)})]}),t.jsx("div",{className:"text-[11px] uppercase tracking-[0.2em] text-[#6a5d52] dark:text-white/60",children:"Приход − план = сумма в период"})]})]}),t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/85 px-5 py-6 text-[#1c1a17] shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-[#1c1a17] dark:text-white dark:shadow-[0_20px_40px_-26px_rgba(0,0,0,0.7)]",children:[t.jsx(ne,{tooltipText:"Фактический остаток / количество незаполненных (непрошедших) дней",children:"Расчётное в день на оставшиеся дни"}),t.jsxs("p",{className:"mt-2 text-xs text-[#6a5d52] dark:text-white/60",children:["(",ee(Ge)," / ",Qe||0," д.)"]}),t.jsx(Te,{className:"mt-3",children:ee(We)})]}),t.jsxs("div",{className:"rounded-lg border border-black/10 bg-white/85 px-5 py-6 text-[#1c1a17] shadow-[0_20px_40px_-26px_rgba(28,26,23,0.6)] dark:border-white/10 dark:bg-[#1c1a17] dark:text-white dark:shadow-[0_20px_40px_-26px_rgba(0,0,0,0.7)]",children:[t.jsx(ne,{tooltipText:"Планируемый остаток +/− фактическая разница − ежедневные траты за период.",tooltipAriaLabel:"Формула фактического остатка",children:"Фактический остаток"}),t.jsxs(qe,{className:"mt-3",children:[t.jsx(xe,{className:"text-[#1e7b4f] dark:text-[#7ce0b3]",children:ee(he)}),t.jsx(xe,{className:`${ce>0?"text-[#1e7b4f] dark:text-[#7ce0b3]":ce<0?"text-[#b0352b] dark:text-[#ff8b7c]":"text-[#6a5d52] dark:text-white/70"}`,children:be(ce).replace(/^([+−-])/,"$1 ")}),t.jsx(Ne,{children:"−"}),t.jsx(xe,{className:"text-[#b0352b] dark:text-[#ff8b7c]",children:ee(pe)}),t.jsx(Ne,{children:"="}),t.jsx(xe,{className:`${he+ce-pe>=0?"text-[#1e7b4f] dark:text-[#7ce0b3]":"text-[#b0352b] dark:text-[#ff8b7c]"}`,children:be(he+ce-pe)})]}),t.jsx("div",{className:"mt-4 h-px w-full bg-black/10 dark:bg-white/10"}),t.jsx(ne,{className:"mt-4",children:"Фактическое среднее в день за период"}),t.jsx(Te,{className:"mt-2",children:ee(Je)})]})]})]}),de&&t.jsx(kt,{currentTitle:we,onCancel:()=>re(!1),onConfirm:()=>Fe(!0),confirmDisabled:M}),oe&&t.jsx(yt,{onCancel:()=>C(!1),onConfirm:rt,confirmDisabled:G}),A&&t.jsx(mt,{href:`/periods/${A.id}`,title:`${ue(A.start_date)} — ${ue(A.end_date)}`,subtitle:`${Me(A.start_date,A.end_date)} дней · ${Le(A.start_date,A.end_date)}`,onClose:()=>{O(null),I(!1),je.current=null},onConfirm:()=>le(!0,je.current??void 0),confirmDisabled:!V||T}),$&&t.jsx("div",{className:"relative z-10 rounded-lg border border-black/10 bg-white/70 px-5 py-3 text-xs text-[#b0352b] dark:border-white/10 dark:bg-white/10 dark:text-[#ff8b7c]",children:$})]})]})}export{Rt as default};
